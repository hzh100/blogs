import{_ as n,c as a,o as s,a as t}from"./app.d95e124d.js";const g='{"title":"http\u7F13\u5B58","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u6D4F\u89C8\u5668http\u7F13\u5B58\u6D41\u7A0B","slug":"\u6D4F\u89C8\u5668http\u7F13\u5B58\u6D41\u7A0B"},{"level":2,"title":"\u5F3A\u7F13\u5B58","slug":"\u5F3A\u7F13\u5B58"},{"level":3,"title":"Expires","slug":"expires"},{"level":3,"title":"Cache-Control","slug":"cache-control"},{"level":2,"title":"\u534F\u5546\u7F13\u5B58","slug":"\u534F\u5546\u7F13\u5B58"},{"level":3,"title":"\u65F6\u95F4 Last-Modified/If-Modified-Since","slug":"\u65F6\u95F4-last-modified-if-modified-since"},{"level":3,"title":"Etag/If-None-Match","slug":"etag-if-none-match"},{"level":2,"title":"\u5F3A\u7F13\u5B58\u548C\u534F\u5546\u7F13\u5B58\u7684\u6574\u4F53\u6D41\u7A0B\u56FE","slug":"\u5F3A\u7F13\u5B58\u548C\u534F\u5546\u7F13\u5B58\u7684\u6574\u4F53\u6D41\u7A0B\u56FE"},{"level":2,"title":"Pragma","slug":"pragma"},{"level":2,"title":"\u4F7F\u7528nodejs\u5B9E\u64CDhttp\u7F13\u5B58\u7B56\u7565","slug":"\u4F7F\u7528nodejs\u5B9E\u64CDhttp\u7F13\u5B58\u7B56\u7565"},{"level":3,"title":"\u6784\u5EFAhttp\u670D\u52A1","slug":"\u6784\u5EFAhttp\u670D\u52A1"},{"level":3,"title":"\u8BBE\u7F6E\u5F3A\u7F13\u5B58Expires","slug":"\u8BBE\u7F6E\u5F3A\u7F13\u5B58expires"},{"level":3,"title":"\u8BBE\u7F6E\u5F3A\u7F13\u5B58Cache-Control: max-age","slug":"\u8BBE\u7F6E\u5F3A\u7F13\u5B58cache-control-max-age"},{"level":3,"title":"\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58\u6700\u540E\u4FEE\u6539\u65E5\u671F","slug":"\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58\u6700\u540E\u4FEE\u6539\u65E5\u671F"},{"level":3,"title":"\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58Etag","slug":"\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58etag"},{"level":2,"title":"\u5173\u4E8E\u8D44\u6E90hash\u89E3\u51B3\u7684\u95EE\u9898","slug":"\u5173\u4E8E\u8D44\u6E90hash\u89E3\u51B3\u7684\u95EE\u9898"},{"level":2,"title":"DNS\u7F13\u5B58","slug":"dns\u7F13\u5B58"},{"level":2,"title":"CDN\u7F13\u5B58","slug":"cdn\u7F13\u5B58"},{"level":2,"title":"hash","slug":"hash"},{"level":3,"title":"query-hash","slug":"query-hash"},{"level":3,"title":"name-hash","slug":"name-hash"},{"level":3,"title":"\u89E3\u51B3\u95EE\u9898","slug":"\u89E3\u51B3\u95EE\u9898"},{"level":2,"title":"\u7406\u60F3\u7F13\u5B58\u7B56\u7565","slug":"\u7406\u60F3\u7F13\u5B58\u7B56\u7565"},{"level":2,"title":"\u5176\u4ED6\u62D3\u5C55","slug":"\u5176\u4ED6\u62D3\u5C55"},{"level":3,"title":"\u6D4F\u89C8\u5668\u7684gzip","slug":"\u6D4F\u89C8\u5668\u7684gzip"},{"level":3,"title":"webpack\u7684hash\u3001chunkhash\u548Ccontenthash\u533A\u522B","slug":"webpack\u7684hash\u3001chunkhash\u548Ccontenthash\u533A\u522B"},{"level":2,"title":"\u53C2\u8003\u8D44\u6599","slug":"\u53C2\u8003\u8D44\u6599"}],"relativePath":"http/http\u7F13\u5B58.md","lastUpdated":1664437294091}',e={},p=t(`<h1 id="http\u7F13\u5B58" tabindex="-1">http\u7F13\u5B58 <a class="header-anchor" href="#http\u7F13\u5B58" aria-hidden="true">#</a></h1><p>\u5173\u4E8Ehttp\u7F13\u5B58\u7684\u80CC\u666F\u4EE5\u53CA\u610F\u4E49\uFF0C\u8FD9\u91CC\u8DF3\u8FC7\u4E0D\u8BB2(\u4E3B\u8981\u7531\u4E8Ehttp\u7684\u65E0\u72B6\u6001\u5BFC\u81F4\u7684\u6027\u80FD\u635F\u8017)\uFF0C\u76F4\u63A5\u4ECEhttp\u7F13\u5B58\u7684\u6D41\u7A0B\u548C\u5982\u4F55\u914D\u7F6E\u8BB2\u8D77 \u76EE\u524D\u6B63\u5728\u5543\u300A\u56FE\u89E3http\u534F\u8BAE\u300B\u4E4B\u540E\u4F1A\u6309\u7167\u4E66\u672C\u7684\u6BCF\u4E00\u7AE0\u51FA\u6587\u7AE0\uFF0C\u5BF9\u4E8E\u5E38\u89C1\u7684http\u76F8\u5173\u95EE\u9898\u4F1A\u5355\u72EC\u8BB2(\u6316\u5751+1)</p><p>\u5148\u8BB0\u4F4F\u51E0\u4E2A\u6982\u5FF5</p><ul><li>\u5F3A\u7F13\u5B58: \u6D4F\u89C8\u5668\u4E0D\u53D1\u8D77http\u8BF7\u6C42\uFF0C\u76F4\u63A5\u4ECE\u6D4F\u89C8\u5668\u7F13\u5B58\u4E2D\u8BFB\u53D6\u8D44\u6E90</li><li>\u534F\u5546\u7F13\u5B58\uFF1A\u6D4F\u89C8\u5668\u53D1\u8D77http\u8BF7\u6C42\uFF0C\u670D\u52A1\u7AEF\u53EA\u8FD4\u56DE\u72B6\u6001\u7801\u8BA9\u6D4F\u89C8\u5668\u8BFB\u53D6\u7F13\u5B58</li><li>http1\uFF1A\u6700\u65E9\u671F\u7684http\u534F\u8BAE</li><li>http1.1\uFF1A\u4F18\u5316\u7F13\u5B58\u7B56\u7565\u5347\u7EA7\u540E\u7684http\u534F\u8BAE</li></ul><h2 id="\u6D4F\u89C8\u5668http\u7F13\u5B58\u6D41\u7A0B" tabindex="-1">\u6D4F\u89C8\u5668http\u7F13\u5B58\u6D41\u7A0B <a class="header-anchor" href="#\u6D4F\u89C8\u5668http\u7F13\u5B58\u6D41\u7A0B" aria-hidden="true">#</a></h2><blockquote><p>\u8FD9\u91CC\u5FFD\u7565\u6D4F\u89C8\u5668\u4E00\u4E2A\u8BF7\u6C42\u53D1\u8D77\u7684\u6240\u6709\u8FC7\u7A0B(DNS\u89E3\u6790\u3001TCP\u3001HTTP)</p></blockquote><p>\u6D4F\u89C8\u5668\u5728\u5BA2\u6237\u7AEF\uFF0C\u4F1A\u6709\u4E00\u4E2A\u5185\u5B58\u7A7A\u95F4\u7528\u4E8E\u5B58\u50A8\u6709http\u7F13\u5B58\u76F8\u5173\u5934\u7684\u6BCF\u6B21\u6709\u54CD\u5E94\u7684http\u8BF7\u6C42</p><p>\u5728\u4E0B\u4E00\u6B21\u8BF7\u6C42\u53D1\u51FA\u524D\uFF0C\u6D4F\u89C8\u5668\u4F1A\u5230\u5185\u5B58\u7A7A\u95F4\u627E\u5230\u76F8\u540Curl\u7684http\u8BF7\u6C42 \u5982\u679C\u4E0A\u4E00\u6B21http\u8BF7\u6C42\u7684\u54CD\u5E94\u5934\u4E2D\u6709http\u7F13\u5B58\u76F8\u5173\u7684\u5B57\u6BB5 \u5C06\u5224\u65AD\u662F\u5426\u547D\u4E2D\u5F3A\u7F13\u5B58\uFF0C\u5982\u679C\u662F\u5219\u4E0D\u53D1\u8D77\u8BF7\u6C42\uFF0C\u5982\u679C\u4E0D\u662F\u5219\u628A\u7F13\u5B58\u76F8\u5173\u7684\u54CD\u5E94\u5934\u5B57\u6BB5\u5904\u7406\u6210\u76F8\u5E94\u7684\u8BF7\u6C42\u5934\u5B57\u6BB5\u53D1\u51FA \u5373</p><ul><li>\u6211\u4EEC\u53EF\u4EE5\u628Ahttp\u5F3A\u7F13\u5B58\u8FC7\u7A0B\u5F53\u6210\u662F\u6D4F\u89C8\u5668\u53D1\u8D77\u8BF7\u6C42\u524D\u53D1\u751F\u7684</li><li>http\u534F\u5546\u7F13\u5B58\u8FC7\u7A0B\u5F53\u6210\u662F\u670D\u52A1\u7AEF\u54CD\u5E94\u7684\u65F6\u5019\u53D1\u751F\u7684</li></ul><p>\u4EE5\u4E0A\u4EC5\u662F\u6D45\u663E\u7684\u731C\u6D4B\uFF0C\u5177\u4F53\u7684\u6D41\u7A0B\u672A\u77E5</p><h2 id="\u5F3A\u7F13\u5B58" tabindex="-1">\u5F3A\u7F13\u5B58 <a class="header-anchor" href="#\u5F3A\u7F13\u5B58" aria-hidden="true">#</a></h2><p>\u5982\u4E0A\u7684\u6D4F\u89C8\u5668http\u7F13\u5B58\u6D41\u7A0B\uFF0Chttp\u5F3A\u7F13\u5B58\u53D1\u751F\u5728\u6D4F\u89C8\u5668\u53D1\u8D77\u8BF7\u6C42\u524D</p><p>\u5F3A\u7F13\u5B58\u5206\u4E3A <code>Disk Cache (\u5B58\u653E\u5728\u786C\u76D8\u4E2D)</code>\u548C <code>Memory Cache (\u5B58\u653E\u5728\u5185\u5B58\u4E2D)</code>\uFF0C\u5B58\u653E\u7684\u4F4D\u7F6E\u662F\u7531\u6D4F\u89C8\u5668\u63A7\u5236\u7684\u3002</p><h3 id="expires" tabindex="-1">Expires <a class="header-anchor" href="#expires" aria-hidden="true">#</a></h3><p>\u7528\u4E8E\u8BBE\u7F6E\u9759\u6001\u8D44\u6E90\u7684<code>\u8FC7\u671F\u65F6\u95F4</code>\u3002\u5B83\u7684\u503C\u4E00\u4E2A<code>GMT\u683C\u5F0F</code>\u7684\u65F6\u95F4\u5B57\u7B26\u4E32\uFF0C\u6BD4\u5982<code>expires:Fri, 27 Jul 2029 13:38:54 GMT</code>\u3002 \u8FD9\u4E2A\u65F6\u95F4\u4EE3\u8868\u7740\u8FD9\u4E2A\u8D44\u6E90\u7684\u5931\u6548\u65F6\u95F4\uFF0C\u5728\u6B64\u65F6\u95F4\u4E4B\u524D\u547D\u4E2D\u7F13\u5B58\u3002</p><p>\u7F3A\u70B9\uFF1A \u6D4F\u89C8\u5668\u7AEF\u65F6\u95F4\u548C\u670D\u52A1\u5668\u65F6\u95F4\u4E0D\u4E00\u81F4\u7684\u65F6\u5019\uFF0C\u4F1A\u6709\u7F13\u5B58\u6709\u6548\u671F\u4E0D\u51C6\u7684\u95EE\u9898(\u662F\u53CC\u65B9\u5404\u81EA\u7684\u7EDD\u5BF9\u65F6\u95F4)</p><h3 id="cache-control" tabindex="-1">Cache-Control <a class="header-anchor" href="#cache-control" aria-hidden="true">#</a></h3><blockquote><p>Cache-Control \u662F HTTP/1.1 \u4E2D\u65B0\u589E\u7684\u5C5E\u6027\uFF0C\u5728\u8BF7\u6C42\u5934\u548C\u54CD\u5E94\u5934\u4E2D\u90FD\u53EF\u4EE5\u4F7F\u7528 \u4F18\u5148\u7EA7\u5728<code>Expires</code>\u4E4B\u4E0A,\u5373\u5982\u679C\u6709<code>Cache-Control</code>\uFF0C\u5C06\u65E0\u89C6<code>Expires</code><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control" target="_blank" rel="noopener noreferrer">Cache-Control MDN</a></p></blockquote><p>\u5E38\u7528\u7684\u5C5E\u6027\u503C\u5982\u6709\uFF1A</p><ul><li>no-store\uFF1A\u7981\u6B62\u4F7F\u7528\u7F13\u5B58\uFF08\u5305\u62EC\u534F\u5546\u7F13\u5B58\uFF09\uFF0C\u6BCF\u6B21\u90FD\u5411\u670D\u52A1\u5668\u8BF7\u6C42\u6700\u65B0\u7684\u8D44\u6E90</li><li>no-cache\uFF1A\u4E0D\u4F7F\u7528\u5F3A\u7F13\u5B58\uFF0C\u9700\u8981\u4E0E\u670D\u52A1\u5668\u9A8C\u8BC1\u7F13\u5B58\u662F\u5426\u65B0\u9C9C</li><li>max-age\uFF1A\u5355\u4F4D\u662F\u79D2\uFF0C\u7F13\u5B58\u65F6\u95F4\u8BA1\u7B97\u7684\u65B9\u5F0F\u662F\u8DDD\u79BB\u53D1\u8D77\u7684\u65F6\u95F4\u7684\u79D2\u6570\uFF0C\u8D85\u8FC7\u95F4\u9694\u7684\u79D2\u6570\u7F13\u5B58\u5931\u6548\u3002\u4E0EExpires\u76F8\u53CD\uFF0C\u65F6\u95F4\u662F\u76F8\u5BF9\u4E8E\u8BF7\u6C42\u7684\u65F6\u95F4\u3002</li><li>s-max-age\uFF1A\u8986\u76D6max-age\u6216\u8005Expires\u5934\uFF0C\u4F46\u662F\u4EC5\u9002\u7528\u4E8E\u5171\u4EAB\u7F13\u5B58(\u6BD4\u5982\u5404\u4E2A\u4EE3\u7406)\uFF0C\u79C1\u6709\u7F13\u5B58\u4F1A\u5FFD\u7565\u5B83\u3002</li><li>private\uFF1A\u4E13\u7528\u4E8E\u4E2A\u4EBA\u7684\u7F13\u5B58\uFF0C\u4E2D\u95F4\u4EE3\u7406\u3001CDN \u7B49\u4E0D\u80FD\u7F13\u5B58\u6B64\u54CD\u5E94\uFF08\u9ED8\u8BA4\u503C\uFF09</li><li>public\uFF1A\u54CD\u5E94\u53EF\u4EE5\u88AB\u4E2D\u95F4\u4EE3\u7406\u3001CDN \u7B49\u7F13\u5B58</li><li>must-revalidate\uFF1A\u5728\u7F13\u5B58\u8FC7\u671F\u524D\u53EF\u4EE5\u4F7F\u7528\uFF0C\u8FC7\u671F\u540E\u5FC5\u987B\u5411\u670D\u52A1\u5668\u9A8C\u8BC1</li></ul><p>Cache-Control\u7684<code>max-age</code>\u662F\u4E00\u4E2A\u76F8\u5BF9\u65F6\u95F4\uFF0C\u4F8B\u5982<code>3600</code>\uFF0C\u4EE3\u8868\u7740\u8D44\u6E90\u7684\u6709\u6548\u671F\u662F3600\u79D2\u4E00\u4E2A\u5C0F\u65F6\u3002\u7531\u4E8E\u662F\u76F8\u5BF9\u65F6\u95F4\uFF0C\u5E76\u4E14\u90FD\u662F\u4E0E\u5BA2\u6237\u7AEF\u65F6\u95F4\u6BD4\u8F83\uFF0C\u6240\u4EE5\u670D\u52A1\u5668\u4E0E\u5BA2\u6237\u7AEF\u65F6\u95F4\u504F\u5DEE\u4E5F\u4E0D\u4F1A\u5BFC\u81F4\u95EE\u9898\u3002</p><p>\u6D41\u7A0B\u5927\u6982\u53EF\u4EE5\u662F\uFF1A \u6D4F\u89C8\u5668\u53D1\u8D77\u8BF7\u6C42\u524D\uFF0C\u5230\u5185\u5B58\u4E2D\u627E\u5230\u4E86\u4E0A\u4E00\u6B21\u76F8\u540Curl\u76F8\u5E94\u7684\u8BF7\u6C42\uFF0C\u5E76\u4E14\u4E0A\u4E00\u6B21\u54CD\u5E94\u5934\u4E2D\u6709<code>max-age</code>\u662F3600\u79D2\uFF0C\u5373\u4E00\u4E2A\u5C0F\u65F6\uFF0C\u5E76\u4E14\u5185\u5B58\u4E2D\u7684\u8BF7\u6C42\u90FD\u4F1A\u6709\u4E2A\u6BCF\u6B21\u53D1\u8D77http\u8BF7\u6C42\u90FD\u4F1A\u751F\u6210\u7684date\uFF0C\u6D4F\u89C8\u5668\u7528\u5F53\u524D\u65F6\u95F4\u548C\u5185\u5B58\u4E2D\u7684\u8BF7\u6C42\u65F6\u95F4\uFF0C\u76F8\u51CF\u5F97\u5230\u7684\u79D2\u6570\u5224\u65AD\u662F\u5426\u53D6\u5185\u5B58\u4E2D\u7684\u76F8\u5E94\u7ED3\u679C\u3002</p><p>\u{1F446} \u6240\u4EE5\uFF0C\u7B2C\u4E09\u7B2C\u56DB\u6B21\u4EE5\u53CA\u4E4B\u540E\u7684\u8BF7\u6C42\u90FD\u662F\u4E0E\u7B2C\u4E00\u6B21\u8BF7\u6C42(\u7F13\u5B58\u4E0B\u6765\u7684http)\u7684\u65F6\u95F4\u505A\u6BD4\u8F83\u7684\uFF0C\u5E76\u4E0D\u662F\u4E0E\u4E0A\u4E00\u6B21\u8BF7\u6C42\u505A\u6BD4\u8F83</p><blockquote><p>\u6839\u636Ehttp\u6807\u51C6\uFF0C\u5982\u679C\u8BF7\u6C42\u5934\u4E0D\u643A\u5E26\u4EFB\u4F55\u5173\u4E8E\u7F13\u5B58\u7684\u6807\u8BB0\u800C\u54CD\u5E94\u5934\u6709\u7F13\u5B58\u76F8\u5173\u5B57\u6BB5\uFF0C\u5219\u7F13\u5B58\u65F6\u95F4\u7B49\u4E8E\u5F53\u524D\u65F6\u95F4\u548C Last-Modified\u65F6\u95F4\u7684\u5DEE\u503C\u768410%\uFF0C\u7B49\u540C\u4E8Ecache-control=max-age=\uFF08date - Last-Modified\uFF09/ 10\uFF0C\u901A\u8FC7fiddler\u6293\u5305\u53EF\u770B\u5230\u82F1\u6587\u539F\u6587\uFF1ANo explicit HTTP Cache Lifetime information was provided.Heuristic expiration policies suggest defaulting to: 10% of the delta between Last-Modified and Date.</p></blockquote><p>\u{1F446} \u4E00\u822C\u8BF7\u6C42\u90FD\u4F1A\u8BBE\u7F6E\u4E0A\u7684\uFF0C\u8FD9\u79CD\u5C5E\u4E8E\u5F88\u6781\u7AEF\u7684\u60C5\u51B5\u5427(\u9762\u8BD5\u9020\u706B\u7BAD\uFF1F)</p><h2 id="\u534F\u5546\u7F13\u5B58" tabindex="-1">\u534F\u5546\u7F13\u5B58 <a class="header-anchor" href="#\u534F\u5546\u7F13\u5B58" aria-hidden="true">#</a></h2><blockquote><p>\u5728\u6D4F\u89C8\u5668\u51B3\u5B9A\u4E0D\u53D6\u5F3A\u7F13\u5B58\u65F6\uFF0C\u53D1\u8D77\u4E86\u8BF7\u6C42\uFF0C\u670D\u52A1\u7AEF\u5C06\u6839\u636E\u8BF7\u6C42\u5934\u4E2Dhttp\u7F13\u5B58\u76F8\u5E94\u5B57\u6BB5\uFF0C\u505A\u51FA\u5BF9\u5E94\u7684\u54CD\u5E94</p></blockquote><h3 id="\u65F6\u95F4-last-modified-if-modified-since" tabindex="-1">\u65F6\u95F4 Last-Modified/If-Modified-Since <a class="header-anchor" href="#\u65F6\u95F4-last-modified-if-modified-since" aria-hidden="true">#</a></h3><blockquote><p>\u534F\u5546\u7F13\u5B58\u9700\u8981\u670D\u52A1\u7AEF\u914D\u5408 \u6D4F\u89C8\u5668\u7B2C\u4E00\u6B21\u8BF7\u6C42\u4E00\u4E2A\u8D44\u6E90\u7684\u65F6\u5019\uFF0C\u670D\u52A1\u5668\u8FD4\u56DE\u7684header\u4E2D\u4F1A\u52A0\u4E0A<code>Last-Modify</code>\uFF0C<code>Last-modify</code>\u662F\u4E00\u4E2A\u65F6\u95F4\u6807\u8BC6\u8BE5\u8D44\u6E90\u7684\u6700\u540E\u4FEE\u6539\u65F6\u95F4\uFF0C\u4F8B\u5982<code>last-modified:Fri, 20 Dec 2019 03:34:57 GMT</code>\u3002</p></blockquote><p>\u7B2C\u4E00\u6B21\u54CD\u5E94\u65F6\uFF0C\u670D\u52A1\u7AEF\u9700\u8981\u5728\u54CD\u5E94\u5934\u4E2D\u8FD4\u56DE\u534F\u5546\u7F13\u5B58\u76F8\u5173\u7684\u5B57\u6BB5\uFF0C\u6D4F\u89C8\u5668\u5B8C\u6210\u7B2C\u4E00\u6B21\u8BF7\u6C42\u54CD\u5E94\uFF0C\u4F1A\u7F13\u5B58\u76F8\u5173\u7684\u534F\u5546\u7F13\u5B58\u5B57\u6BB5</p><p>\u6D41\u7A0B\u5927\u6982\u53EF\u4EE5\u662F\uFF1A</p><ul><li>\u6D4F\u89C8\u5668\u53D1\u8D77\u8BF7\u6C42\u524D\uFF0C\u5230\u5185\u5B58\u4E2D\u627E\u5230\u4E86\u4E0A\u4E00\u6B21\u76F8\u540Curl\u76F8\u5E94\u7684\u8BF7\u6C42\uFF0C\u51B3\u5B9A\u4E0D\u8D70\u5F3A\u7F13\u5B58\u3002\u5C06\u627E\u5230\u5185\u5B58\u4E2D\u7684\u54CD\u5E94\u5934\u4E2D\u534F\u5546\u7F13\u5B58\u76F8\u5173\u7684\u5B57\u6BB5<code>Last-Modify</code>\uFF0C\u62FC\u63A5\u5230\u8FD9\u6B21\u53D1\u8D77\u7684http\u8BF7\u6C42\u5934\u4E2D<code>If-Modified-Since</code>\uFF0C\u5F00\u59CB\u53D1\u8D77\u8BF7\u6C42\u3002</li><li>\u670D\u52A1\u5668\u63A5\u6536\u5230\u8BF7\u6C42\uFF0C\u68C0\u67E5\u8BF7\u6C42\u5934\u4E2D\u7684\u534F\u5546\u7F13\u5B58\u76F8\u5173\u5B57\u6BB5\uFF0C\u53D1\u73B0\u6709<code>If-Modified-Since</code>\uFF0C\u62FFurl\u76F8\u5E94\u7684\u8D44\u6E90\u4FEE\u6539\u65F6\u95F4\u505A\u6BD4\u8F83\uFF0C\u53D1\u73B0\u4FEE\u6539\u65F6\u95F4\u662F\u76F8\u540C\u7684\u5219\u76F4\u63A5\u8FD4\u56DE304\u54CD\u5E94\u7801\uFF0C\u8BA9\u6D4F\u89C8\u5668\u53D6\u7F13\u5B58\u3002\u5426\u5219\u54CD\u5E94\u771F\u5B9E\u8D44\u6E90\uFF0C\u5E76\u4E14\u54CD\u5E94\u5934\u4F1A\u5E26\u4E0A\u65B0\u7684<code>Last-Modify</code></li></ul><p>\u7F3A\u70B9\uFF1A</p><ul><li>\u4E0D\u540C\u670D\u52A1\u5668\u8D44\u6E90\u7684\u4FEE\u6539\u65F6\u95F4\u7CBE\u5EA6\u53EF\u80FD\u4E0D\u540C\uFF0C\u5B58\u5728\u76F8\u540C\u65F6\u95F4\u8D44\u6E90\u5185\u5BB9\u53D8\u66F4\u7684\u60C5\u51B5\u3002\u5BFC\u81F4\u670D\u52A1\u5668\u5224\u65AD\u672C\u6B21\u8BF7\u6C42\u8FD4\u56DE304\uFF08\u540E\u679C\u4E25\u91CD\uFF0C\u7528\u6237\u8BBF\u95EE\u7684\u662F\u9519\u8BEF\u5185\u5BB9\uFF09</li><li>\u8D44\u6E90\u5185\u5BB9\u6CA1\u6709\u5B9E\u8D28\u53D8\u5316\uFF0C\u4F46\u662F\u4FEE\u6539\u65F6\u95F4\u66F4\u65B0\u4E86\uFF0C\u5982\u52A0\u4E86\u56DE\u8F66\u6216\u662F\u7A7A\u683C\uFF0C\u5982\u670D\u52A1\u5668\u8D44\u6E90\u662F\u5168\u91CF\u5220\u9664\u5168\u91CF\u66F4\u65B0\u7684\u3002\u5BFC\u81F4\u670D\u52A1\u5668\u5224\u65AD\u672C\u6B21\u8BF7\u6C42\u8FD4\u56DE200\u771F\u5B9E\u8BF7\u6C42 (\u5B9E\u9645\u8BA9\u6D4F\u89C8\u5668\u53D6\u7F13\u5B58\u5C31\u53EF\u4EE5,\u6027\u80FD\u6D6A\u8D39)</li></ul><h3 id="etag-if-none-match" tabindex="-1">Etag/If-None-Match <a class="header-anchor" href="#etag-if-none-match" aria-hidden="true">#</a></h3><blockquote><p>Etag/If-None-Match\u8FD4\u56DE\u7684\u662F\u4E00\u4E2A\u6821\u9A8C\u7801\uFF08ETag: entity tag\uFF09\u3002 Etag\uFF1A\u670D\u52A1\u5668\u54CD\u5E94\u8BF7\u6C42\u65F6\uFF0C\u544A\u8BC9\u6D4F\u89C8\u5668\u5F53\u524D\u8D44\u6E90\u5728\u670D\u52A1\u5668\u7684\u552F\u4E00\u6807\u8BC6\uFF08\u751F\u6210\u89C4\u5219\u7531\u670D\u52A1\u5668\u5B9A\u4E49\uFF09\u3002nginx\u4E2D\uFF0Cetag\u4F1A\u9ED8\u8BA4\u589E\u52A0\uFF0C\u5982\u679C\u9700\u8981\u5173\u95ED\uFF0C\u9700\u8981\u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u8BBE\u7F6E\uFF1Aetag off;</p></blockquote><p>\u4E0E\u{1F446} <code>\u65F6\u95F4 Last-Modified/If-Modified-Since</code> \u7C7B\u4F3C\uFF0C\u8FD9\u79CD\u534F\u5546\u7F13\u5B58\u6BD4\u5BF9\u6D41\u7A0B\u76F8\u540C\uFF0C\u5E76\u4E14\u662F\u4E92\u65A5\u7684\u5173\u7CFB\uFF0Cetag\u7684\u4F18\u5148\u7EA7\u66F4\u9AD8(\u5373\u6709etag\u5C06\u65E0\u89C6<code>Last-Modified</code>)</p><p>\u6D41\u7A0B\u5927\u6982\u53EF\u4EE5\u662F\uFF1A</p><ul><li>\u6D4F\u89C8\u5668\u53D1\u8D77\u8BF7\u6C42\u524D\uFF0C\u5230\u5185\u5B58\u4E2D\u627E\u5230\u4E86\u4E0A\u4E00\u6B21\u76F8\u540Curl\u76F8\u5E94\u7684\u8BF7\u6C42\uFF0C\u51B3\u5B9A\u4E0D\u8D70\u5F3A\u7F13\u5B58\u3002\u5C06\u627E\u5230\u5185\u5B58\u4E2D\u7684\u54CD\u5E94\u5934\u4E2D\u534F\u5546\u7F13\u5B58\u76F8\u5173\u7684\u5B57\u6BB5<code>Etag</code>\uFF0C\u62FC\u63A5\u5230\u8FD9\u6B21\u53D1\u8D77\u7684http\u8BF7\u6C42\u5934\u4E2D<code>If-None-Match</code>\uFF0C\u5F00\u59CB\u53D1\u8D77\u8BF7\u6C42\u3002</li><li>\u670D\u52A1\u5668\u63A5\u6536\u5230\u8BF7\u6C42\uFF0C\u68C0\u67E5\u8BF7\u6C42\u5934\u4E2D\u7684\u534F\u5546\u7F13\u5B58\u76F8\u5173\u5B57\u6BB5\uFF0C\u53D1\u73B0\u6709<code>If-None-Match</code>\uFF0C\u62FFurl\u76F8\u5E94\u7684\u8D44\u6E90\u7684\u552F\u4E00\u6807\u8BC6\u505A\u6BD4\u8F83\uFF0C\u53D1\u73B0\u8D44\u6E90\u552F\u4E00\u6807\u8BC6\u662F\u76F8\u540C\u7684\u5219\u76F4\u63A5\u8FD4\u56DE304\u54CD\u5E94\u7801\uFF0C\u8BA9\u6D4F\u89C8\u5668\u53D6\u7F13\u5B58\u3002\u5426\u5219\u54CD\u5E94\u771F\u5B9E\u8D44\u6E90\uFF0C\u5E76\u4E14\u54CD\u5E94\u5934\u4F1A\u5E26\u4E0A\u65B0\u7684<code>Etag</code></li></ul><p>ETag \u6709\u5F3A\u5F31\u6821\u9A8C\u4E4B\u5206\uFF0C\u5982\u679C hash \u7801\u662F\u4EE5 &quot;W/&quot; \u5F00\u5934\u7684\u4E00\u4E32\u5B57\u7B26\u4E32\uFF0C\u8BF4\u660E\u6B64\u65F6\u534F\u5546\u7F13\u5B58\u7684\u6821\u9A8C\u662F\u5F31\u6821\u9A8C\u7684\uFF0C\u53EA\u6709\u670D\u52A1\u5668\u4E0A\u7684\u6587\u4EF6\u5DEE\u5F02\uFF08\u6839\u636E ETag \u8BA1\u7B97\u65B9\u5F0F\u6765\u51B3\u5B9A\uFF09\u8FBE\u5230\u80FD\u591F\u89E6\u53D1 hash \u503C\u540E\u7F00\u53D8\u5316\u7684\u65F6\u5019\uFF0C\u624D\u4F1A\u771F\u6B63\u5730\u8BF7\u6C42\u8D44\u6E90</p><h2 id="\u5F3A\u7F13\u5B58\u548C\u534F\u5546\u7F13\u5B58\u7684\u6574\u4F53\u6D41\u7A0B\u56FE" tabindex="-1">\u5F3A\u7F13\u5B58\u548C\u534F\u5546\u7F13\u5B58\u7684\u6574\u4F53\u6D41\u7A0B\u56FE <a class="header-anchor" href="#\u5F3A\u7F13\u5B58\u548C\u534F\u5546\u7F13\u5B58\u7684\u6574\u4F53\u6D41\u7A0B\u56FE" aria-hidden="true">#</a></h2><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20211226174336.png" alt="http\u7F13\u5B58\u7684\u6D41\u7A0B"></p><p>\u4E0D\u8D70\u5F3A\u7F13\u5B58\u7684\u51E0\u79CD\u65B9\u5F0F</p><h2 id="pragma" tabindex="-1">Pragma <a class="header-anchor" href="#pragma" aria-hidden="true">#</a></h2><blockquote><p>Pragma \u53EA\u6709\u4E00\u4E2A\u5C5E\u6027\u503C\uFF0C\u5C31\u662F no-cache \u6CE8\u610F\u4E0D\u662F\u5C5E\u4E8ECache-Control\u4E0B\u7684\u67D0\u79CD\u573A\u666F\uFF0C\u800C\u662F\u548CCache-Control\u3001Expires \u540C\u7EA7\u522B\u7684\u63A7\u5236\u53C2\u6570\uFF0C</p></blockquote><p>\u6548\u679C\u548C Cache-Control \u4E2D\u7684 no-cache \u4E00\u81F4\uFF0C\u4E0D\u4F7F\u7528\u5F3A\u7F13\u5B58\uFF0C\u4F46\u662F\u4F1A\u534F\u5546\u7F13\u5B58\uFF0C\u9700\u8981\u4E0E\u670D\u52A1\u5668\u9A8C\u8BC1\u7F13\u5B58\u662F\u5426\u65B0\u9C9C\uFF0C\u5728 3 \u4E2A\u5934\u90E8\u5C5E\u6027\u4E2D\u7684\u4F18\u5148\u7EA7\u6700\u9AD8\u3002</p><h2 id="\u4F7F\u7528nodejs\u5B9E\u64CDhttp\u7F13\u5B58\u7B56\u7565" tabindex="-1">\u4F7F\u7528nodejs\u5B9E\u64CDhttp\u7F13\u5B58\u7B56\u7565 <a class="header-anchor" href="#\u4F7F\u7528nodejs\u5B9E\u64CDhttp\u7F13\u5B58\u7B56\u7565" aria-hidden="true">#</a></h2><h3 id="\u6784\u5EFAhttp\u670D\u52A1" tabindex="-1">\u6784\u5EFAhttp\u670D\u52A1 <a class="header-anchor" href="#\u6784\u5EFAhttp\u670D\u52A1" aria-hidden="true">#</a></h3><div class="language-js"><pre><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span>resp</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token comment">// resp.writeHead(200, {</span>
  <span class="token comment">//   &quot;Content-type&quot;: &quot;text/html&quot; // \u4E0D\u8FD4\u56DE \u6D4F\u89C8\u5668\u4E5F\u53EF\u4EE5\u731C\u6D4B\u51FA\u7C7B\u578B\uFF0C\u4F46\u662F\u4E00\u822C\u90FD\u8FD4\u56DE</span>
  <span class="token comment">// });</span>
  <span class="token keyword">const</span> html <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#39;./dist/index.html&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;utf8&#39;</span><span class="token punctuation">)</span>
  resp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">9080</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Server runing at part: 9080&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u{1F446} \u7528nodejs\u8D77\u4E00\u4E2A\u670D\u52A1 <code>localhost:9080</code> \u8BBF\u95EE\u8FD9\u4E2A\u5730\u5740\uFF0C\u4F1A\u8BFB\u53D6\u672C\u5730\u6587\u4EF6\u4E2D\u7684 <code>dist/index.html</code>\uFF0C\u8FD4\u56DE\u56DE\u53BB</p><ul><li><code>fs.readFileSync()</code> \u662F\u540C\u6B65\u65B9\u6CD5\uFF0C\u5E76\u4E14\u4E0D\u9700\u8981await\uFF0C\u7B2C\u4E8C\u4E2A\u53C2\u6570\u6587\u4EF6\u7C7B\u578B\u5FC5\u987B\u5199\u4E0A<code>utf8</code> \u4E0D\u53EF\u7701\u7565</li><li><code>nodejs</code>\u7684<code>http\u670D\u52A1</code>\u9ED8\u8BA4\u8FD4\u56DE<code>\u72B6\u6001\u7801200</code>\uFF0C\u672C\u6B21\u793A\u4F8B\u53EF\u4EE5\u4E0D\u8BBE\u7F6E\u54CD\u5E94\u72B6\u6001</li><li><code>Content-type</code>\u6D4F\u89C8\u5668\u4E5F\u53EF\u4EE5\u6839\u636E\u5185\u5BB9\u731C\u6D4B\uFF0C\u4F46\u662F\u4F1A\u6709\u731C\u6D4B\u6027\u80FD\u635F\u8017\uFF0C\u5B9E\u9645\u573A\u666F\u5FC5\u987B\u5E26\u4E0A\u76F8\u5E94\u7C7B\u578B\uFF0C\u672C\u6B21\u793A\u4F8B\u4E0D\u8BBE\u7F6E</li><li>\u5B8C\u6574http\u670D\u52A1\u8FD8\u8981\u505A\u597D\u5404\u79CD\u5E38\u89C4\u5F02\u5E38\u5904\u7406,\u672C\u6B21\u793A\u4F8B\u4E0D\u8BBE\u7F6E <ul><li>\u542F\u670D\u52A1\u5668\u5931\u8D25</li><li>\u903B\u8F91\u5F02\u5E38500</li><li>\u8D44\u6E90\u4E0D\u5B58\u5728404</li><li>...</li></ul></li></ul><h3 id="\u8BBE\u7F6E\u5F3A\u7F13\u5B58expires" tabindex="-1">\u8BBE\u7F6E\u5F3A\u7F13\u5B58Expires <a class="header-anchor" href="#\u8BBE\u7F6E\u5F3A\u7F13\u5B58expires" aria-hidden="true">#</a></h3><div class="language-js"><pre><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span>resp</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  time<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// \u65F6\u95F4\u6233\u8BA1\u7B97\u5355\u4F4D\u662F\u6BEB\u79D2</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Expires&#39;</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span><span class="token function">toUTCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> html <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#39;./dist/index.html&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;utf8&#39;</span><span class="token punctuation">)</span>
  resp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">9080</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Server runing at part: 9080&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u{1F446} \u8BBE\u7F6E10\u79D2\u540E\u7684\u5230\u671F\u65F6\u95F4</p><ul><li>\u8BBE\u7F6E\u5230\u671F\u65F6\u95F4\u662FUTC\u65E5\u671F\u683C\u5F0F\uFF0C\u56E0\u6B64\u4F7F\u7528<code>toUTCString()</code>\u8F6C\u5316</li><li><code>toUTCString()</code>\u662F\u65E5\u671F\u5BF9\u8C61\u7684\u65B9\u6CD5\uFF0C\u56E0\u6B64\u8BA1\u7B97\u65F6\u95F4\u8981\u7528<code>setTime()</code></li><li>\u65E5\u671F\u5BF9\u8C61\u8F6C\u65F6\u95F4\u6233\u8BA1\u7B97\u7684\u5355\u4F4D\u662F\u6BEB\u79D2</li></ul><p>\u6D4F\u89C8\u5668\u9A8C\u8BC1\u53D1\u73B0\u5237\u65B0\u867D\u7136\u6BCF\u6B21\u54CD\u5E94\u5934\u90FD\u6709<code>Expires</code>,\u4F46\u662F\u6BCF\u6B21\u8BF7\u6C42\u5934\u90FD\u4F1A\u5E26\u4E0A<code>Cache-Control: max-age=0</code> \u6211\u4EEC\u4E0A\u9762\u8BB2\u5230\u4E86<code>cache-control</code>\u4F18\u5148\u7EA7\u9AD8\u4E8E<code>expires</code>\uFF0C\u6240\u4EE5\u6BCF\u6B21\u8BF7\u6C42\u90FD\u4E0D\u4F1A\u8D70\u5F3A\u7F13\u5B58</p><p>\u8FD9\u4E2A\u8BF7\u6C42\u5934\u7684<code>Cache-Control</code>\uFF0C\u662F\u6D4F\u89C8\u5668\u5730\u5740\u680F\u76F4\u63A5\u53D1\u8D77get\u8BF7\u6C42\u9ED8\u8BA4\u5E26\u4E0A\u7684</p><p>\u89E3\u51B3\u529E\u6CD5</p><ul><li>\u6539\u5199\u6210ajax\u8BF7\u6C42\u8BBF\u95EE\u6211\u4EEC\u7684http\u670D\u52A1\uFF0C\u800C\u4E0D\u7528\u6D4F\u89C8\u5668\u5730\u5740\u680F\u76F4\u63A5get\u8BF7\u6C42</li><li>\u6D4F\u89C8\u5668\u5F00\u7740\u4E00\u4E2Aget\u8BF7\u6C42\uFF0C\u518D\u65B0\u5F00\u4E00\u4E2A\u6807\u7B7E\u9875\uFF0C\u63D0\u524D\u6253\u5F00\u63A7\u5236\u53F0\uFF0C\u8F93\u5165\u5730\u5740\u518D\u6B21\u76F4\u63A5\u53D1\u8D77get\u8BF7\u6C42\u3002\u5E76\u4E14\u65B0\u5F00\u7684\u6807\u7B7E\u9875\u4E5F\u4E0D\u80FD\u5237\u65B0\u6D4B\u8BD5\uFF0C\u53EA\u80FD\u91CD\u590D\u5F00\u65B0\u7684\u6807\u7B7E\u9875\u6D4B\u8BD5\uFF0C\u8FD9\u6837\u53EF\u4EE5\u8BA9\u6D4F\u89C8\u5668\u4E0D\u5E26\u4E0A<code>max-age=0</code></li></ul><h3 id="\u8BBE\u7F6E\u5F3A\u7F13\u5B58cache-control-max-age" tabindex="-1">\u8BBE\u7F6E\u5F3A\u7F13\u5B58<code>Cache-Control: max-age</code> <a class="header-anchor" href="#\u8BBE\u7F6E\u5F3A\u7F13\u5B58cache-control-max-age" aria-hidden="true">#</a></h3><div class="language-js"><pre><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span>resp</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Cache-Control&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;max-age=10&#39;</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> html <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#39;./dist/index.html&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;utf8&#39;</span><span class="token punctuation">)</span>
  resp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">9080</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Server runing at part: 9080&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u{1F446} \u8BBE\u7F6E10\u79D2\u540E\u7684\u76F8\u5BF9\u65F6\u95F4\u5230\u671F \u540C\u6837\u7528\u65B0\u5F00\u6807\u7B7E\u7684\u5F62\u5F0F\u8FDB\u884C\u9A8C\u8BC1</p><h3 id="\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58\u6700\u540E\u4FEE\u6539\u65E5\u671F" tabindex="-1">\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58\u6700\u540E\u4FEE\u6539\u65E5\u671F <a class="header-anchor" href="#\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58\u6700\u540E\u4FEE\u6539\u65E5\u671F" aria-hidden="true">#</a></h3><div class="language-js"><pre><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span>resp</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> stats <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span><span class="token string">&#39;./dist/index.html&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> lastModified <span class="token operator">=</span> stats<span class="token punctuation">.</span>mtime<span class="token punctuation">.</span><span class="token function">toUTCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// resp.setHeader(&#39;Cache-Control&#39;,&#39;max-age=5&#39;)</span>
  <span class="token comment">// \u5982\u679C\u8981\u627E\u7684\u8D44\u6E90\u4FEE\u6539\u65F6\u95F4\u7B49\u4E8E\u8BF7\u6C42\u5934\u4E2D\u7684\u7F13\u5B58\u4FEE\u6539\u65F6\u95F4\uFF0C\u5219\u8FD4\u56DE304</span>
  <span class="token keyword">const</span> requestModified <span class="token operator">=</span> request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;if-modified-since&#39;</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>requestModified <span class="token operator">&amp;&amp;</span> requestModified <span class="token operator">===</span> lastModified<span class="token punctuation">)</span><span class="token punctuation">{</span>
    resp<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">304</span><span class="token punctuation">;</span>
    resp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Last-Modified&#39;</span><span class="token punctuation">,</span>lastModified<span class="token punctuation">)</span> <span class="token comment">// \u6D4F\u89C8\u5668\u8BF7\u6C42\u5934\u4F1A\u81EA\u52A8\u5E26\u4E0A if-modified-since</span>
  <span class="token keyword">const</span> html <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#39;./dist/index.html&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;utf8&#39;</span><span class="token punctuation">)</span>
  resp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">9080</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Server runing at part: 9080&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u534F\u5546\u7F13\u5B58\u4F1A\u53D1\u73B0 \u72B6\u6001\u7801\u8BBE\u7F6E\u4E0D\u751F\u6548\uFF0C\u4F46\u662F\u8D44\u6E90size\u53EF\u4EE5\u770B\u51FA\u6765\u662F\u8D70\u4E86304\u7684</p><p>\u5728html\u4E0A\u52A0\u5916\u94FEcss\u5C1D\u8BD5\uFF0C\u53EF\u4EE5\u770B\u5230\u6709304\u72B6\u6001\u751F\u6548\uFF0C\u4F46\u662F\u7B49\u4E00\u4F1A\u518D\u5237\u65B0\uFF0C\u72B6\u6001\u53D8\u6210\u4E86200 \u8D44\u6E90size\u8FD8\u662F\u53EF\u4EE5\u8D70\u4E86304 \u5F88\u5947\u602A\uFF0C\u53EA\u6709\u72B6\u6001\u8BBE\u7F6E\u4E0D\u751F\u6548 \u5230safire\u6D4F\u89C8\u5668\u5C1D\u8BD5\uFF0C\u53D1\u73B0\u53EF\u4EE5\u6B63\u5E38304\uFF0C\u8FD9\u91CC\u7684\u539F\u56E0\u4E0D\u660E\uFF0C\u4EE5\u540E\u77E5\u9053\u4E86\u518D\u56DE\u6765\u8865\u5427\u3002\u3002\u3002</p><p>\u4E0D\u5F71\u54CD\u6211\u4EEChttp\u7F13\u5B58\u6D4B\u8BD5</p><h3 id="\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58etag" tabindex="-1">\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58Etag <a class="header-anchor" href="#\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58etag" aria-hidden="true">#</a></h3><p>\u53EF\u4EE5\u5148\u7528\u4E0A\u9762\u4EE3\u7801\u793A\u4F8B\u6765\u9A8C\u8BC1modified\u7684\u7F3A\u70B9\uFF0C\u5982\u4E0A\u6240\u8FF0\uFF0C\u6587\u4EF6\u5185\u5BB9\u6CA1\u6709\u4FEE\u6539\uFF0C\u4E5F\u4F1A\u91CD\u65B0\u8BF7\u6C42\uFF0C\u5220\u9664\u7136\u540E\u65B0\u5EFA\u4E5F\u4F1A\u91CD\u65B0\u8BF7\u6C42\uFF0C\u7CBE\u5EA6\u57281\u79D2\u5185\u4F1A\u8BF7\u6C42\u65E7\u7684\u8D44\u6E90</p><div class="language-js"><pre><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;crypto&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span>resp</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Cache-Control&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;max-age=0&#39;</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> buffer <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#39;./dist/index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">&#39;md5&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  hash<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> md5 <span class="token operator">=</span> hash<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">&#39;hex&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> requestEtage <span class="token operator">=</span> request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;if-none-match&#39;</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>requestEtage <span class="token operator">&amp;&amp;</span> requestEtage <span class="token operator">===</span> md5<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    resp<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">304</span><span class="token punctuation">;</span>
    resp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;etag&#39;</span><span class="token punctuation">,</span>md5<span class="token punctuation">)</span> <span class="token comment">// \u6D4F\u89C8\u5668\u8BF7\u6C42\u5934\u4F1A\u81EA\u52A8\u5E26\u4E0A if-modified-since</span>
  <span class="token keyword">const</span> html <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#39;./dist/index.html&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;utf8&#39;</span><span class="token punctuation">)</span>
  resp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">9080</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Server runing at part: 9080&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u4E3A\u4E86\u4FDD\u8BC1 lastModified \u4E0D\u5F71\u54CD\u7F13\u5B58\uFF0C\u628A\u901A\u8FC7 Last-Modified/If-Modified-Since \u8BF7\u6C42\u5934\u5220\u9664 \u7136\u540E\u4FEE\u6539 html\uFF0C\u589E\u52A0\u4E00\u4E2A\u7A7A\u683C\u540E\u518D\u5220\u9664\u4E00\u4E2A\u7A7A\u683C\uFF0C\u4FDD\u6301\u6587\u4EF6\u5185\u5BB9\u4E0D\u53D8\uFF0C\u4F46\u6587\u4EF6\u7684\u4FEE\u6539\u65F6\u95F4\u6539\u53D8\uFF0C\u53D1\u8D77\u8BF7\u6C42\uFF0C\u7531\u4E8E\u751F\u6210 ETag \u7684\u65B9\u5F0F\u662F\u901A\u8FC7\u5BF9\u6587\u4EF6\u5185\u5BB9\u8FDB\u884C MD5 \u52A0\u5BC6\u751F\u6210\uFF0C\u6240\u4EE5\u867D\u7136\u4FEE\u6539\u65F6\u95F4\u53D8\u5316\u4E86\uFF0C\u8BF7\u6C42\u8FD4\u56DE\u4E86 304 \uFF0C\u8BFB\u53D6\u6D4F\u89C8\u5668\u7F13\u5B58\u3002</p><p>\u91C7\u7528\u7684\u662F\u5BF9\u6587\u4EF6\u8FDB\u884C MD5 \u52A0\u5BC6\u6765\u8BA1\u7B97\u5176 hash \u503C\u3002</p><p>\u6CE8\uFF1A\u53EA\u662F\u4E3A\u4E86\u6F14\u793A\u7528\uFF0C\u5B9E\u9645\u8BA1\u7B97\u4E0D\u662F\u901A\u8FC7 MD5 \u52A0\u5BC6\u7684\uFF0CApache \u9ED8\u8BA4\u901A\u8FC7 FileEtag \u4E2D FileEtag INode Mtime Size \u7684\u914D\u7F6E\u81EA\u52A8\u751F\u6210 ETag\uFF0C\u7528\u6237\u53EF\u4EE5\u901A\u8FC7\u81EA\u5B9A\u4E49\u7684\u65B9\u5F0F\u6765\u4FEE\u6539\u6587\u4EF6\u751F\u6210 ETag \u7684\u65B9\u5F0F\u3002</p><h2 id="\u5173\u4E8E\u8D44\u6E90hash\u89E3\u51B3\u7684\u95EE\u9898" tabindex="-1">\u5173\u4E8E\u8D44\u6E90hash\u89E3\u51B3\u7684\u95EE\u9898 <a class="header-anchor" href="#\u5173\u4E8E\u8D44\u6E90hash\u89E3\u51B3\u7684\u95EE\u9898" aria-hidden="true">#</a></h2><p>\u5BF9\u4E8Eimg\uFF0Ccss\uFF0Cjs\uFF0Cfonts\u7B49\u975Ehtml\u8D44\u6E90\uFF0C\u6211\u4EEC\u53EF\u4EE5\u76F4\u63A5\u8003\u8651max-age\u914D\u7F6E\u7684\u65F6\u95F4\u53EF\u4EE5\u5C3D\u53EF\u80FD\u4E45\uFF0C\u7C7B\u4F3C\u4E8E\u7F13\u5B58\u89C4\u5219\u6848\u4F8B\u4E2D\uFF0C<code>cache-control: max-age=31535000</code>\u914D\u7F6E365\u5929\u7684\u7F13\u5B58 \u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u8FD9\u6837\u914D\u7F6E\u5E76\u4E0D\u4EE3\u8868\u8FD9\u4E9B\u8D44\u6E90\u5C31\u4E00\u5B9A\u4E00\u5E74\u4E0D\u53D8\uFF0C\u5176\u6839\u672C\u539F\u56E0\u5728\u4E8E\u76EE\u524D\u524D\u7AEF\u6784\u5EFA\u5DE5\u5177\u5728\u9759\u6001\u8D44\u6E90\u4E2D\u90FD\u4F1A\u52A0\u5165\u6233\u7684\u6982\u5FF5\uFF08\u4F8B\u5982\uFF0Cwebpack\u4E2D\u7684[hash]\uFF0Cgulp\u4E2D\u7684gulp-rev\uFF09 \u6BCF\u6B21\u4FEE\u6539\u5747\u4F1A\u6539\u53D8\u6587\u4EF6\u540D\u6216\u589E\u52A0query\u53C2\u6570\uFF0C\u672C\u8D28\u4E0A\u6539\u53D8\u4E86\u8BF7\u6C42\u7684\u5730\u5740\uFF0C\u4E5F\u5C31\u4E0D\u5B58\u5728\u7F13\u5B58\u66F4\u65B0\u7684\u95EE\u9898 \u6BCF\u6B21\u90FD\u662F\u4E00\u6B21\u65B0\u7684\u5F3A\u7F13\u5B58</p><h2 id="dns\u7F13\u5B58" tabindex="-1">DNS\u7F13\u5B58 <a class="header-anchor" href="#dns\u7F13\u5B58" aria-hidden="true">#</a></h2><p>\u6D4F\u89C8\u5668\u8BF7\u6C42\u57DF\u540D</p><ol><li>\u6D4F\u89C8\u5668\u4ECE\u81EA\u8EAB\u7684DNS\u7F13\u5B58\u4E2D\u53BB\u67E5\u627E</li><li>\u6D4F\u89C8\u5668\u4ECE\u672C\u5730host\u6587\u4EF6\u67E5\u627E</li><li>\u6D4F\u89C8\u5668\u4ECE\u64CD\u4F5C\u7CFB\u7EDF\u91CC\u7684DNS\u7F13\u5B58\u4E2D\u67E5\u627E</li><li>\u6D4F\u89C8\u5668\u8BF7\u6C42\u672C\u5730\u57DF\u540D\u670D\u52A1\u5668\uFF08\u4F8B\u5982\u7535\u4FE1\uFF09</li><li>\u6D4F\u89C8\u5668\u8BF7\u6C42DNS\u670D\u52A1\u5668\u9012\u5F52\u67E5\u627E</li></ol><p>\u6B64\u65F6\u83B7\u5F97\u6E90\u670D\u52A1\u5668IP\uFF0C\u4EE5\u53CA\u6E90\u670D\u52A1\u5668\u6839\u636E\u57DF\u540D\u914D\u7F6E\u7684\u8D1F\u8F7D\u5747\u8861\u670D\u52A1\u5668CDN\u7B56\u7565\u670D\u52A1\u5668IP \u672C\u5730\u57DF\u540D\u670D\u52A1\u5668\u5C06\u4E0D\u76F4\u63A5\u8FD4\u56DE\u6E90\u670D\u52A1\u5668IP\uFF0C\u800C\u662F\u53BB\u8BBF\u95EECDN\u670D\u52A1\u5668\uFF0C\u8D1F\u8F7D\u5747\u8861\u540E\u8FD4\u56DE\u7684\u4E2D\u95F4\u670D\u52A1\u5668(\u4EE3\u7406\u670D\u52A1\u5668IP/CDN\u670D\u52A1\u5668\uFF1F)</p><p>\u56E0\u6B64\u6D4F\u89C8\u5668\u62FF\u5230\u5E76\u8BBF\u95EE\u7684\u662F\u4E2D\u95F4\u670D\u52A1\u5668IP(\u5728\u6D4F\u89C8\u5668\u663E\u793A\u7684\u662F\u57DF\u540D)</p><p>\u5173\u4E8E\u57DF\u540D\u89E3\u6790\u8FC7\u7A0B(\u7531\u53F3\u5F80\u5DE6) <img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20211224112314.png" alt="\u5173\u4E8E\u57DF\u540D\u89E3\u6790\u8FC7\u7A0B"></p><h2 id="cdn\u7F13\u5B58" tabindex="-1">CDN\u7F13\u5B58 <a class="header-anchor" href="#cdn\u7F13\u5B58" aria-hidden="true">#</a></h2><p>\u4E0A\u8FF0\u7684http\u7F13\u5B58\u90FD\u662F\u5BA2\u6237\u7AEF\u81EA\u5DF1\u7684\u7F13\u5B58\uFF0C\u5373\u53EA\u6709\u5F53\u6211\u8BBF\u95EE\u8FC7\u4E00\u6B21\u5E76\u7F13\u5B58\u624D\u80FD\u8D70\u7F13\u5B58 \u800CCDN\u5219\u53EF\u4EE5\u505A\u5230\u591A\u4E2A\u5BA2\u6237\u7AEF\uFF0C\u53EA\u8981\u6709\u4E00\u4E2A\u4EBA\u8BBF\u95EE\uFF0CCDN\u670D\u52A1\u5668\u5C31\u53EF\u4EE5\u7F13\u5B58\u4E0B\u6765\uFF0C\u4E0B\u6B21\u5176\u4ED6\u4EBA\u518D\u8BBF\u95EE\u5230CDN\u5C31\u76F4\u63A5\u7ED9\u4F60CDN\u4E2D\u7684\u7F13\u5B58 \u5F53\u7136\u5BA2\u6237\u7AEF\u8BBF\u95EECDN\uFF0C\u8FD8\u662F\u4E00\u4E2Ahttp\u8BF7\u6C42\uFF0C\u53EA\u4E0D\u8FC7\u6BD4\u76F4\u63A5\u8BBF\u95EE\u6E90\u670D\u52A1\u5668\u8981\u66F4\u5FEB</p><p>\u7F13\u5B58CDN\u7F13\u5B58\u7684\u5EFA\u8BAE\u89C2\u770B <a href="https://www.bilibili.com/video/BV1jS4y197zi" target="_blank" rel="noopener noreferrer">\u4EC0\u4E48\u662FCDN\uFF1FCDN\u80FD\u4E3A\u6211\u4EEC\u505A\u4EC0\u4E48\uFF1F\u6211\u4EEC\u4E3A\u4EC0\u4E48\u8981\u4E86\u89E3\u4ED6\uFF1F-bilibili</a></p><p>\u5F53\u6D4F\u89C8\u5668\u5411CDN\u8282\u70B9\u8BF7\u6C42\u6570\u636E\u65F6\uFF0CCDN\u8282\u70B9\u4F1A\u5224\u65AD\u7F13\u5B58\u6570\u636E\u662F\u5426\u8FC7\u671F\uFF0C\u82E5\u7F13\u5B58\u6570\u636E\u5E76\u6CA1\u6709\u8FC7\u671F\uFF0C\u5219\u76F4\u63A5\u5C06\u7F13\u5B58\u6570\u636E\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\uFF1B\u5426\u5219\uFF0CCDN\u8282\u70B9\u5C31\u4F1A\u5411\u670D\u52A1\u5668\u53D1\u51FA\u56DE\u6E90\u8BF7\u6C42\uFF0C\u4ECE\u670D\u52A1\u5668\u62C9\u53D6\u6700\u65B0\u6570\u636E\uFF0C\u66F4\u65B0\u672C\u5730\u7F13\u5B58\uFF0C\u5E76\u5C06\u6700\u65B0\u6570\u636E\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\u3002</p><blockquote><p>CDN\u670D\u52A1\u5546\u4E00\u822C\u4F1A\u63D0\u4F9B\u57FA\u4E8E\u6587\u4EF6\u540E\u7F00\u3001\u76EE\u5F55\u591A\u4E2A\u7EF4\u5EA6\u6765\u6307\u5B9ACDN\u7F13\u5B58\u65F6\u95F4\uFF0C\u4E3A\u7528\u6237\u63D0\u4F9B\u66F4\u7CBE\u7EC6\u5316\u7684\u7F13\u5B58\u7BA1\u7406</p></blockquote><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20211229194429.png" alt="\u817E\u8BAF\u4E91CDN\u8BBE\u7F6E"> \u{1F446}\u817E\u8BAF\u4E91CDN\u8BBE\u7F6E\uFF0C\u4E0D\u4EC5\u53EF\u4EE5\u6CBF\u7528\u6E90\u670D\u52A1\u7AEF\u8BBE\u7F6E\u7684\u7F13\u5B58\u7B56\u7565\uFF0C\u8FD8\u53EF\u4EE5\u81EA\u5B9A\u4E49\u7F13\u5B58\u7B56\u7565</p><p><strong>\u5F53CDN\u6709\u81EA\u5B9A\u4E49\u5F3A\u7F13\u5B58\u65F6\u95F4\uFF0C\u5E76\u4E14\u6E90\u670D\u52A1\u5668\u66F4\u65B0\u4E86\u8D44\u6E90\u600E\u4E48\u529E?</strong></p><p>\u5982\u679C\u6211\u4EEChttp\u7F13\u5B58\u8BBE\u7F6E<code>cache-control: max-age=600</code>\uFF0C\u5373\u7F13\u5B5810\u5206\u949F\uFF0C\u4F46cdn\u7F13\u5B58\u914D\u7F6E\u4E2D\u8BBE\u7F6E\u6587\u4EF6\u7F13\u5B58\u65F6\u95F4\u4E3A1\u5C0F\u65F6\uFF0C\u90A3\u4E48\u5C31\u4F1A\u51FA\u73B0\u5982\u4E0B\u60C5\u51B5\uFF0C\u6587\u4EF6\u88AB\u8BBF\u95EE\u540E\u7B2C12\u5206\u949F\u4FEE\u6539\u5E76\u4E0A\u4F20\u5230\u670D\u52A1\u5668\uFF0C\u7528\u6237\u91CD\u65B0\u8BBF\u95EE\u8D44\u6E90\uFF0C\u54CD\u5E94\u7801\u4F1A\u662F304\uFF0C\u5BF9\u6BD4\u7F13\u5B58\u672A\u4FEE\u6539\uFF0C\u8D44\u6E90\u4F9D\u7136\u662F\u65E7\u7684\uFF0C\u4E00\u4E2A\u5C0F\u65F6\u540E\u518D\u6B21\u8BBF\u95EE\u624D\u80FD\u66F4\u65B0\u4E3A\u6700\u65B0\u8D44\u6E90</p><p>\u5F53\u6211\u4EEC\u5FC5\u987B\u8981\u5728\u7F13\u5B58\u671F\u5185\u4FEE\u6539\u6587\u4EF6\uFF0C\u5E76\u4E14\u4E0D\u60F3\u5F71\u54CD\u7528\u6237\u4F53\u9A8C\uFF0C\u90A3\u4E48\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528cdn\u670D\u52A1\u5546\u63D0\u4F9B\u7684\u5F3A\u5236\u66F4\u65B0\u7F13\u5B58\u529F\u80FD\uFF0C\u4E3B\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u8FD9\u91CC\u7684\u5F3A\u5236\u66F4\u65B0\u662F\u66F4\u65B0\u670D\u52A1\u7AEF\u7F13\u5B58\uFF0Chttp\u7F13\u5B58\u4F9D\u7136\u6309\u7167http\u5934\u90E8\u89C4\u5219\u8FDB\u884C\u81EA\u5DF1\u7684\u7F13\u5B58\u5904\u7406\uFF0C\u5E76\u4E0D\u4F1A\u53D7\u5230\u5F71\u54CD\u3002</p><p><strong>CDN\u5176\u4ED6\u5E94\u7528\u4E3E\u4F8B</strong> \u9664\u4E86\u9759\u6001\u5185\u5BB9\uFF0CCDN\u670D\u52A1\u5668\u8FD8\u53EF\u4EE5\u83B7\u53D6\u52A8\u6001\u5185\u5BB9\uFF0C\u5982\u670D\u52A1\u5668\u65F6\u95F4\uFF0C\u5BA2\u6237\u7AEF\u8BBF\u95EE\u6E90\u670D\u52A1\u5668(\u4E2D\u95F4\u94FE\u8DEF\u957F\u53EF\u80FD\u65AD\u8FDE)\u65F6\u95F4\u53EF\u80FD\u4E0D\u51C6\u6216\u662F\u83B7\u53D6\u4E0D\u5230 \u90A3\u5C31\u8BA9\u5BA2\u6237\u7AEF\u83B7\u53D6CDN\u7684\u670D\u52A1\u5668\u65F6\u95F4\uFF0C\u6E90\u670D\u52A1\u5668\u4E5F\u4EE5CDN\u670D\u52A1\u5668\u65F6\u95F4\u4E3A\u51C6</p><h2 id="hash" tabindex="-1">hash <a class="header-anchor" href="#hash" aria-hidden="true">#</a></h2><blockquote><p>\u5728\u8BA8\u8BBA\u7406\u60F3\u7F13\u5B58\u6A21\u578B\u524D\uFF0C\u6211\u4EEC\u5148\u770B\u770B\u8D44\u6E90hash\u7684\u91C7\u7528\u5F62\u5F0F</p></blockquote><p>\u5728webpack\u7B49\u6253\u5305\u5DE5\u5177\u4E2D\uFF0Chash\u7684\u751F\u6210\u89C4\u5219\u5206\u4E3A: <code>hash</code>\u3001<code>contenhash</code>... \u6211\u4EEC\u53EA\u8003\u8651\u6700\u7406\u60F3\u7684<code>contentHash</code></p><p>\u6D4F\u89C8\u5668\u8BC6\u522B\u8D44\u6E90\u53EF\u4EE5\u8003\u8651\u7F13\u5B58\u7684\u6807\u8BC6\u662Furl\uFF0C\u5305\u62ECurl\u53C2\u6570</p><h3 id="query-hash" tabindex="-1">query-hash <a class="header-anchor" href="#query-hash" aria-hidden="true">#</a></h3><p>\u90A3\u4E48\u6211\u4EEC\u53EF\u4EE5\u5229\u7528\u53C2\u6570\u505Ahash <code>myapp/homePage.js?hash=1234</code> \u8FD9\u6837\u5C31\u80FD\u901A\u8FC7\u66F4\u65B0hash\u6765\u4F7F\u6D4F\u89C8\u5668\u4ECE\u91CD\u65B0\u53D1\u8D77\u5168\u65B0\u8BF7\u6C42(\u4E0D\u8D70\u534F\u5546\u7F13\u5B58,\u4F1A\u662F\u5B8C\u5168\u9996\u6B21\u8BF7\u6C42)</p><p>\u7F3A\u70B9</p><ul><li>hash\u7684\u503C\u9700\u8981\u6211\u4EEC\u81EA\u5DF1\u62FC\u4E0A\u8D44\u6E90\u8BF7\u6C42,\u5982:html\u4E2D\u7684srcipt\u662F\u5E26\u53C2\u6570\u7684\u3001\u5F02\u6B65js\u7684require\u5E26\u53C2\u6570</li><li>hash\u7684\u503C\u7B80\u5355\u505A\u6CD5\u6BCF\u6B21\u6253\u5305\u90FD\u662F\u65B0\u7684hash\uFF0C\u4F1A\u5BFC\u81F4\u6CA1\u66F4\u65B0\u7684\u8D44\u6E90\u4E5F\u91CD\u65B0\u8BF7\u6C42\u3002\u6216\u8005\u9760\u6211\u4EEC\u81EA\u5DF1\u5B9E\u73B0\u597D\u7684hash\u5BF9\u5E94\u5173\u7CFB\uFF0C\u53EA\u66F4\u65B0\u9700\u8981\u66F4\u65B0\u7684hash</li><li>\u8986\u76D6\u5F0F\u90E8\u7F72,\u56E0\u4E3Ahash\u4E3A\u53C2\u6570\uFF0C\u90E8\u7F72\u76F8\u540C\u8D44\u6E90\u5C06\u662F\u540C\u540D\u8D44\u6E90\uFF0C\u4E0A\u670D\u52A1\u5668\u4F1A\u8986\u76D6\u65E7\u8D44\u6E90\u3002\u5982\u679C\u8D44\u6E90\u8981\u5206\u7C7B\u4E0A\u4F20CDN\u670D\u52A1\u5668\uFF0C\u4F1A\u51FA\u73B0\u4E0A\u4F20\u4E0D\u540C\u7C7B\u8D44\u6E90\u66F4\u65B0\u5148\u540E\u987A\u5E8F\u95EE\u9898</li></ul><p>\u4F18\u70B9</p><ul><li>\u8986\u76D6\u5F0F\u90E8\u7F72\uFF0C\u4E0D\u4F1A\u4EA7\u751F\u65E0\u7528\u7684\u65E7\u8D44\u6E90</li></ul><h3 id="name-hash" tabindex="-1">name-hash <a class="header-anchor" href="#name-hash" aria-hidden="true">#</a></h3><p>\u628Ahash\u76F4\u63A5\u4F5C\u4E3A\u6587\u4EF6\u540D <code>myapp/homePage.1234.js</code> \u51CF\u5C11\u6211\u4EEC\u81EA\u5DF1\u5B9E\u73B0hash\u548C\u6587\u4EF6\u5BF9\u5E94\u5173\u7CFB\u7684\u5DE5\u4F5C\u91CF\uFF0C\u6211\u4EEC\u53EA\u9700\u8981\u628Acontenthash\u8F93\u51FA\u5230\u6587\u4EF6\u540D\uFF0C\u5C31\u53EF\u4EE5\u505A\u5230\u7CBE\u786E\u7684\u6587\u4EF6\u662F\u5426\u66F4\u65B0\u6807\u8BC6</p><p>\u4F18\u70B9</p><ul><li>\u53EF\u4EE5\u7CBE\u786E\u6BCF\u4E2A\u6587\u4EF6\u5185\u5BB9\u662F\u5426\u4FEE\u6539\u8FC7\u7684\u6807\u8BC6</li><li>\u5982\u679C\u8D44\u6E90\u5206\u7C7B\u4E0A\u4F20CDN\u670D\u52A1\u5668\uFF0C\u56E0\u4E3A\u65E7\u8D44\u6E90\u65B0\u8D44\u6E90\u4F1A\u5E76\u5B58\uFF0C\u6240\u4EE5\u5148\u628A\u88AB\u4F9D\u8D56\u88AB\u8BF7\u6C42\u7684\u8D44\u6E90\u4E0A\u4F20\uFF0C\u518D\u4E0A\u4F20\u5165\u53E3\u8D44\u6E90\u5C31\u53EF\u4EE5\u907F\u514D\u51FA\u73B0\u95EE\u9898</li></ul><p>\u7F3A\u70B9</p><ul><li>\u968F\u7740\u65F6\u95F4\u63A8\u79FB\uFF0C\u76F8\u540C\u8D44\u6E90\u6587\u4EF6\u4F1A\u7559\u5B58\u5F88\u591A\u4EFD\u65E7\u7684\uFF0C\u5E76\u4E14\u4E0D\u597D\u968F\u4FBF\u5220\u9664\uFF0C\u9700\u8981\u5236\u8BA2\u597D\u6E05\u9664\u89C4\u5219</li></ul><h3 id="\u89E3\u51B3\u95EE\u9898" tabindex="-1">\u89E3\u51B3\u95EE\u9898 <a class="header-anchor" href="#\u89E3\u51B3\u95EE\u9898" aria-hidden="true">#</a></h3><blockquote><p>\u6211\u4EEC\u5C1D\u8BD5\u4E0D\u8003\u8651\u590D\u6742\u5EA6\uFF0C\u5BF9\u4E0A\u8FF0\u4E24\u79CD\u65B9\u6848\u505A\u51FA\u5408\u9002\u7684\u89E3\u51B3\u65B9\u6848</p></blockquote><ol><li><p>query-hash hash\u548C\u6587\u4EF6\u7684\u5BF9\u5E94\u5173\u7CFB</p></li><li><p>CDN+\u8986\u76D6\u5F0F\u90E8\u7F72</p></li><li><p>name-hash\uFF0C\u6E05\u9664\u65E7\u8D44\u6E90\u673A\u5236</p></li></ol><h2 id="\u7406\u60F3\u7F13\u5B58\u7B56\u7565" tabindex="-1">\u7406\u60F3\u7F13\u5B58\u7B56\u7565 <a class="header-anchor" href="#\u7406\u60F3\u7F13\u5B58\u7B56\u7565" aria-hidden="true">#</a></h2><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20211229174408.png" alt="\u7406\u60F3\u7F13\u5B58\u7B56\u7565"></p><p>\u7406\u60F3\u7F13\u5B58\u7B56\u7565\uFF0C\u5C06\u8D44\u6E90\u7B80\u5355\u7684\u5206\u4E3A\u4E24\u79CD</p><ul><li>\u5E26hash/\u7248\u672C\u53F7\u7684\u8D44\u6E90(html\u3001css\u3001js\u3001\u56FE\u7247\u3001\u5B57\u4F53\u7B49)</li><li>\u4E0D\u5E26hash/\u7248\u672C\u53F7\u7684\u8D44\u6E90(html\u3001css\u3001js\u3001\u56FE\u7247\u3001\u5B57\u4F53\u7B49)</li></ul><p>\u5E26hash\u7684\u8D44\u6E90\uFF0C\u76F8\u5F53\u4E8E\u6211\u4EEC\u628A\u6D4F\u89C8\u5668\u662F\u5426\u8981\u53D6\u7F13\u5B58\u7684\u5224\u65AD\u4EA4\u7ED9\u4E86\u6253\u5305\u5DE5\u5177\uFF0C\u66F4\u65B0\u4E86\u8D44\u6E90\uFF0C\u6D4F\u89C8\u5668\u5C31\u91CD\u65B0\u83B7\u53D6\u3002 \u8FD9\u91CC\u7528service Worker\uFF0C\u66FF\u4EE3\u5F3A\u7F13\u5B58365\u5929\uFF0C\u53EA\u662F\u4E3A\u4E86\u8D44\u6E90\u53EF\u4EE5\u79BB\u7EBF\u83B7\u53D6\uFF0C\u5B9E\u9645\u4E0A\u7528\u6C38\u4E45http\u5F3A\u7F13\u5B58\u76F8\u540C\u6548\u679C</p><p>\u4E0D\u5E26hash\u7684\u8D44\u6E90\uFF0C\u8BBE\u7F6E\u5F3A\u7F13\u5B5810\u5206\u949F\uFF0C\u534F\u5546\u7F13\u5B58\u4F9D\u9760etag\u3002\u5E76\u4E14\u9760CDN\u7F13\u5B58\uFF0CCDN\u7F13\u5B58\u5728\u4E0A\u9762\u8BB2\u8FC7\uFF0C\u7F13\u5B58\u673A\u5236\u548C\u6D4F\u89C8\u5668\u662F\u7C7B\u4F3C</p><p>\u8FD8\u6709\u4E0D\u7F13\u5B58\u7684\u5982html\u8D44\u6E90\uFF0C\u8FD9\u91CC\u5FFD\u7565</p><p>\u5F53\u7136\uFF0C\u8FD9\u53EA\u662F\u7406\u60F3\u6A21\u578B\uFF0C\u5B9E\u9645\u573A\u666F\u8981\u8003\u8651\u5F88\u591A\u56E0\u7D20</p><h2 id="\u5176\u4ED6\u62D3\u5C55" tabindex="-1">\u5176\u4ED6\u62D3\u5C55 <a class="header-anchor" href="#\u5176\u4ED6\u62D3\u5C55" aria-hidden="true">#</a></h2><h3 id="\u6D4F\u89C8\u5668\u7684gzip" tabindex="-1">\u6D4F\u89C8\u5668\u7684gzip <a class="header-anchor" href="#\u6D4F\u89C8\u5668\u7684gzip" aria-hidden="true">#</a></h3><ul><li>\u7ED9\u9759\u6001\u8D44\u6E90\u670D\u52A1\u5668http\u5F00\u542Fgzip,(nodejs\u6765\u538B\u7F29\uFF1F) \u548C\u7F13\u5B58\u4E00\u6837\uFF0C\u53EA\u8981\u6709\u6807\u8BC6\uFF0C\u6D4F\u89C8\u5668\u5C31\u4F1A\u81EA\u5DF1\u53BB\u505A\u89E3\u538B</li></ul><p>\u9700\u8981\u6CE8\u610F\u7684\u662F\u538B\u7F29\u7684\u6B65\u9AA4\u7531\u8C01\u53BB\u505A</p><h3 id="webpack\u7684hash\u3001chunkhash\u548Ccontenthash\u533A\u522B" tabindex="-1">webpack\u7684hash\u3001chunkhash\u548Ccontenthash\u533A\u522B <a class="header-anchor" href="#webpack\u7684hash\u3001chunkhash\u548Ccontenthash\u533A\u522B" aria-hidden="true">#</a></h3><ul><li>hash\uFF1A\u6839\u636E\u6253\u5305\u4E2D\u6240\u6709\u7684\u6587\u4EF6\u8BA1\u7B97\u51FA\u7684hash\u503C\u3002\u5728\u4E00\u6B21\u6253\u5305\u4E2D\uFF0C\u6240\u6709\u51FA\u53E3\u6587\u4EF6\u7684filename\u83B7\u5F97\u7684[hash]\u90FD\u662F\u4E00\u6837\u7684\u3002</li><li>chunkhash\uFF1A\u6839\u636E\u6253\u5305\u8FC7\u7A0B\u4E2D\u5F53\u524Dchunk\u8BA1\u7B97\u51FA\u7684hash\u503C\u3002\u5982\u679CWebpack\u914D\u7F6E\u662F\u591A\u5165\u53E3\u914D\u7F6E\uFF0C\u90A3\u4E48\u901A\u5E38\u4F1A\u751F\u6210\u591A\u4E2Achunk\uFF0C\u6BCF\u4E2Achunk\u5BF9\u5E94\u7684\u51FA\u53E3filename\u83B7\u5F97\u7684[chunkhash]\u662F\u4E0D\u4E00\u6837\u7684</li><li>contenthash\u6709\u70B9\u50CFchunkhash\uFF0C\u662F\u6839\u636E\u6253\u5305\u65F6CSS\u5185\u5BB9\u8BA1\u7B97\u51FA\u7684hash\u503C\u3002\u4E00\u822C\u5728\u4F7F\u7528\u63D0\u53D6CSS\u7684loader\u6216plugin\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u4F7F\u7528contenthash</li></ul><h2 id="\u53C2\u8003\u8D44\u6599" tabindex="-1">\u53C2\u8003\u8D44\u6599 <a class="header-anchor" href="#\u53C2\u8003\u8D44\u6599" aria-hidden="true">#</a></h2><ul><li><a href="https://juejin.cn/post/6844903709982490638" target="_blank" rel="noopener noreferrer">http\u7F13\u5B58\u4E0Ecdn\u7F13\u5B58\u914D\u7F6E\u6307\u5357</a></li><li><a href="https://zhuanlan.zhihu.com/p/24467558" target="_blank" rel="noopener noreferrer">\u3010\u817E\u8BAFBugly\u5E72\u8D27\u5206\u4EAB\u3011\u5F7B\u5E95\u5F04\u61C2 Http \u7F13\u5B58\u673A\u5236 - \u57FA\u4E8E\u7F13\u5B58\u7B56\u7565\u4E09\u8981\u7D20\u5206\u89E3\u6CD5</a></li><li><a href="https://zhuanlan.zhihu.com/p/65722520" target="_blank" rel="noopener noreferrer">\u804A\u804A CDN \u7F13\u5B58\u4E0E\u6D4F\u89C8\u5668\u7F13\u5B58</a></li><li><a href="https://naluduo.vip/Web-Performance-Optimization/cache" target="_blank" rel="noopener noreferrer">\u5FAE\u8C08 Web \u524D\u7AEF\u6027\u80FD\u4F18\u5316-\u7F13\u5B58\u7BC7</a></li><li><a href="https://zhuanlan.zhihu.com/p/28113197" target="_blank" rel="noopener noreferrer">\u8BBE\u8BA1\u4E00\u4E2A\u65E0\u61C8\u53EF\u51FB\u7684\u6D4F\u89C8\u5668\u7F13\u5B58\u65B9\u6848\uFF1A\u5173\u4E8E\u601D\u8DEF\uFF0C\u7EC6\u8282\uFF0CServiceWorker\uFF0C\u4EE5\u53CAHTTP/2</a></li></ul>`,126),o=[p];function c(l,i,u,r,h,k){return s(),a("div",null,o)}var f=n(e,[["render",c]]);export{g as __pageData,f as default};
