<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>懒人版 | blog</title>
    <meta name="description" content="vue、js、nodejs等等的学习记录">
    <link rel="stylesheet" href="/assets/style.49eed234.css">
    <link rel="modulepreload" href="/assets/Home.ae65bc00.js">
    <link rel="modulepreload" href="/assets/app.d95e124d.js">
    <link rel="modulepreload" href="/assets/http_http2.md.f913a313.lean.js">
    
    <meta name="twitter:title" content="懒人版 | blog">
  <meta property="og:title" content="懒人版 | blog">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="blog, back to home" data-v-675d8756 data-v-cc01ef16><!----> blog</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://gitee.com/hzh100" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>gitee <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://gitee.com/hzh100" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>gitee <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item"> 介绍</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/">介绍</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">http</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item active" href="/http/http2">http2</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#懒人版">懒人版</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#http1-0的问题">http1.0的问题</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#http1-1的问题">http1.1的问题</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#http2的全双工模式">http2的全双工模式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#http2的多路复用">http2的多路复用</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#http2的并发效果">http2的并发效果</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#http2的头部压缩">http2的头部压缩</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#http2的二进制流-http1-1是字符串，流更容易分割">http2的二进制流: http1.1是字符串，流更容易分割</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#http2的服务器推送">http2的服务器推送</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#用nodejs手写http2静态服务器和http1-1静态服务器对比">用nodejs手写http2静态服务器和http1.1静态服务器对比</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#总结">总结</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#http2多路复用和http1-1的长连接keep-alive的区别">http2多路复用和http1.1的长连接keep-alive的区别</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#为什么http1-1不能实现多路复用">为什么http1.1不能实现多路复用</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#在不改动-http-1-1-的语义、⽅法、状态码、uri-以及⾸部字段等等的情况下-http-2-是如何过渡到http1-1呢">在不改动 HTTP/1.1 的语义、⽅法、状态码、URI 以及⾸部字段等等的情况下, HTTP/2 是如何过渡到http1.1呢?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#promise实现控制最大并发量，控制响应顺序">promise实现控制最大并发量，控制响应顺序</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#参考资料">参考资料</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/http/http3">http3</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/http/http缓存">http缓存</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">innermanage</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/innermanage/内管前端工程">内管前端工程</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">interview</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/JS基础">JS基础</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/TODO">TODO</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/前端面试之道">前端面试之道</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/各种题目01">各种题目01</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-callbind">手写系列-callbind</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-instanceof">手写系列-instanceof</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-map和filter和reduce">手写系列-map和filter和reduce</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-new原理">手写系列-new原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-setTime模拟setInterval">手写系列-setTime模拟setInterval</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-发布订阅和观察者">手写系列-发布订阅和观察者</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-复杂axios">手写系列-复杂axios</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-复杂promise">手写系列-复杂promise</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-数组转树">手写系列-数组转树</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-深拷贝">手写系列-深拷贝</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-防抖节流">手写系列-防抖节流</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/算法01">算法01</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">jiagou</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/monorepo">monorepo</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/从0到1构建符合标准的公共库">从0到1构建符合标准的公共库</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/切换主题方案">切换主题方案</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/前端基础建设与架构30讲">前端基础建设与架构30讲</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/搭建组件库">搭建组件库</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/深入babel">深入babel</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/自动生成按需导出目录">自动生成按需导出目录</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/表单组件带校验功能">表单组件带校验功能</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">js</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/js/class和构造函数">class和构造函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/dayFormat正则的使用">dayFormat正则的使用</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/luhn算法">luhn算法</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/Object.entries">Object.entries</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/proxy">proxy</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/优雅的Class">优雅的Class</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/前端模块化">前端模块化</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/浏览器垃圾回收">浏览器垃圾回收</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/深入babel">深入babel</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/闭包与垃圾回收">闭包与垃圾回收</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">microFrontend</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/microFrontend/介绍">介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/microFrontend/拟定微前端架构设计">拟定微前端架构设计</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/microFrontend/架构思想">架构思想</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">node</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/node/cheetah-learn">cheetah-learn</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/node/cli相关学习">cli相关学习</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">performance</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/performance/serviceWorker">serviceWorker</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/performance/ssr">ssr</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/performance/慕课网web性能优化">慕课网web性能优化</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">typescript</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/typescript/vue2加ts">vue2加ts</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">vue</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/create-vue脚手架">create-vue脚手架</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/esbuild使用">esbuild使用</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/keep-alive原理">keep-alive原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/vue-router实现原理">vue-router实现原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/模板编译">模板编译</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/路由页面历史栈的处理">路由页面历史栈的处理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-01模板语法">重学vue-01模板语法</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-02数据驱动视图">重学vue-02数据驱动视图</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-03render函数">重学vue-03render函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-04内置指令">重学vue-04内置指令</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-05filter多余吗">重学vue-05filter多余吗</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-06computer">重学vue-06computer</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-07watch">重学vue-07watch</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-08组件">重学vue-08组件</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-09生命周期">重学vue-09生命周期</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-10ref是什么">重学vue-10ref是什么</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-11nextTick">重学vue-11nextTick</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-8组件通信">重学vue-8组件通信</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-vue.use">重学vue-vue.use</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-动画内置组件">重学vue-动画内置组件</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">vue3</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue3/elementPlus">elementPlus</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue3/入门">入门</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">webComponents</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/webComponents/1. webComponent介绍">1. webComponent介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webComponents/2. customElements">2. customElements</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">webpack</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/1">1</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/实现一个自己的脚手架">实现一个自己的脚手架</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-01打包工具的思考">重学webpack-01打包工具的思考</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-02模块化原理">重学webpack-02模块化原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-03loader">重学webpack-03loader</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-04plugin">重学webpack-04plugin</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-05HMR热更新">重学webpack-05HMR热更新</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">week</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/week/202110-1">202110-1</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/week/202110-2">202110-2</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/week/202111-1">202111-1</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/week/缓存工具方法思路">缓存工具方法思路</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">work</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/work/ios小白条问题">ios小白条问题</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h2 id="懒人版" tabindex="-1">懒人版 <a class="header-anchor" href="#懒人版" aria-hidden="true">#</a></h2><p>http1.0每次请求都建立TCP断开TCP</p><p>http1.1只建立1个TCP连接，不断开，但是每个请求要按顺序排队 浏览器提供可以同时建立6-8个TCP连接，实现并发效果</p><p>http2只建立1个TCP连接，不断开，每个请求可以并发请求并且乱序响应</p><h2 id="http1-0的问题" tabindex="-1">http1.0的问题 <a class="header-anchor" href="#http1-0的问题" aria-hidden="true">#</a></h2><p>每个http请求都要重新建立TCP连接，并且是等待上一个TCP连接结束断开连接之后才建立下一个TCP连接</p><h2 id="http1-1的问题" tabindex="-1">http1.1的问题 <a class="header-anchor" href="#http1-1的问题" aria-hidden="true">#</a></h2><p>http1.1默认支持长连接(持久连接)来提升速度</p><p>http1.0则加一个 <code>Connetion:keep-alive</code> 即可开启</p><p>http1.1中手动关闭一个持久连接是 <code>Connetion:close</code></p><p>长连接虽然支持一个TCP连接同时发送多个http请求(http管道机制)，但是因为协议规定响应要按请求顺序返回，并且响应并不能同时返回，需要一个一个返回 因此会出现，前面的请求响应耗时导致虽然共用了1个TCP连接同时发起的请求，要等前面的响应完成才能响应（队头阻塞）</p><p>这样依然没能充分利用1个TCP连接的空闲时间</p><p>也正是因为1个TCP连接的请求效率在当下请求数越来越多,资源越来越大的互联网应用下是远远不够的 衍生了各种提升http并发性能的方法</p><ul><li>浏览器支持1个域名同时建立6-8个TCP连接，发起请求的时候会自动选择1条TCP连接去发送</li><li>资源放在不同域名下，让应用支持更多的TCP连接数</li><li>图片资源做成base64减少请求的数量，小图合并成雪碧图减少请求的数量</li><li>js资源打包成一个大chunk，来减少请求数量</li><li>资源懒加载</li></ul><p>队头阻塞体现在真实场景是，一个响应久的请求回占用一个TCP连接，导致原本6个可用的连接变少</p><p>浏览器不允许更多的TCP连接原因是：假设一个客户端可以同时建立无限制的TCP连接，客户数一多同一时间会对服务器造成很大压力(极端情况也就是DDOS攻击)</p><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20220226155840.png" alt=""></p><h2 id="http2的全双工模式" tabindex="-1">http2的全双工模式 <a class="header-anchor" href="#http2的全双工模式" aria-hidden="true">#</a></h2><p>http1.1的队头阻塞等问题，证明通过允许多个TCP连接并不能解决问题，必须要1个TCP连接支持并发才能很好的提高性能(同时解决建立多个TCP连接的耗时)</p><p>虽然http1.1实现了tcp的长连接，在一个tcp链接通道中，我们可以连续处理多个http请求响应，但是这个处理过程是半双工模式，也就是同一时刻只能处理一个request的请求或者响应，后面的request必须等到前面的请求响应之后才能进行。</p><ul><li>半双工：同一时间内，链接上只能有一方发送数据，另一方接受数据。</li><li>全双工：同一时间内，两端都可以发送或接受数据</li></ul><p>http/2实现了全双工通信，具体表现为：浏览器针对同一个域名的资源，只建立一个tcp连接通道，所有的针对这个域名的请求全部在这个通道中完成</p><p>即多个完整的http请求同时发送，发送的过程是有一定顺序的整体，服务端接收处理后乱序响应</p><p>不再按请求顺序返回，直接乱序响应(也可以通过设置优先级制定顺序)</p><h2 id="http2的多路复用" tabindex="-1">http2的多路复用 <a class="header-anchor" href="#http2的多路复用" aria-hidden="true">#</a></h2><p>http2 基于把文本字符格式的http数改为流的形式，实现分割成帧，实现多个请求是交错发送，交错处理，在响应时组装成各自的响应</p><ul><li>浏览器还是只支持6-8个TCP连接</li><li>同域名下所有通信都在单个连接上完成</li><li>单个连接上可以并行交错的请求和响应，之间互不干扰</li><li>该连接可以承载任意数量的双向数据流。</li><li>每个请求都可以带一个31bit的优先值，0表示最高优先级， 数值越大优先级越低。有了这个优先值，客户端和服务器就可以在处理不同的流时采取不同的策略，以最优的方式发送流、消息和帧。</li><li>每个数据流都以消息的形式发送，而消息又由一个或多个帧组成。多个帧之间可以乱序发送，根据帧首部的流标识可以重新组装</li></ul><h2 id="http2的并发效果" tabindex="-1">http2的并发效果 <a class="header-anchor" href="#http2的并发效果" aria-hidden="true">#</a></h2><p>在上述http1.1和http2的区分下</p><p>在实际效果上会发现一些应用http2并没有提升多少速度</p><p>这里分析一下原因</p><ul><li>同时建立6个TCP连接并且没有队头阻塞的情况下,http1.1与http2对比的性能损耗主要在建立另外5个TCP连接上</li><li>以及每6个连接的请求耗时如果时间都不长，或者要并发的数量其实没有很多，看上去就会和http2并发所有请求区别不会很大</li><li>假如我们是本地启前端静态服务器，并发很多请求在http1.1下会跟http2没多大区别，因为建立TCP连接很快，响应也很快</li></ul><p>所以http2更明显的效果要体现在</p><ul><li>多图场景</li><li>音视频场景</li><li>ESM模块化场景，ESBuild等</li></ul><h2 id="http2的头部压缩" tabindex="-1">http2的头部压缩 <a class="header-anchor" href="#http2的头部压缩" aria-hidden="true">#</a></h2><ul><li>索引表 常用单词转为索引匹配</li><li>压缩编码HPACK</li></ul><h2 id="http2的二进制流-http1-1是字符串，流更容易分割" tabindex="-1">http2的二进制流: http1.1是字符串，流更容易分割 <a class="header-anchor" href="#http2的二进制流-http1-1是字符串，流更容易分割" aria-hidden="true">#</a></h2><ul><li>HTTP/2 采用二进制格式传输数据，而非 HTTP 1.x 的文本格式，二进制协议解析起来更高效。 HTTP / 1 的请求和响应报文，都是由起始行，首部和实体正文（可选）组成，各部分之间以文本换行符分隔。HTTP/2 将请求和响应数据分割为更小的帧，并且它们采用二进制编码。</li></ul><h2 id="http2的服务器推送" tabindex="-1">http2的服务器推送 <a class="header-anchor" href="#http2的服务器推送" aria-hidden="true">#</a></h2><ul><li>服务端可以主动把JS和CSS文件推送给客户端，而不需要客户端解析HTML时再发送这些请求。</li></ul><h2 id="用nodejs手写http2静态服务器和http1-1静态服务器对比" tabindex="-1">用nodejs手写http2静态服务器和http1.1静态服务器对比 <a class="header-anchor" href="#用nodejs手写http2静态服务器和http1-1静态服务器对比" aria-hidden="true">#</a></h2><p>TODO:</p><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-hidden="true">#</a></h2><h3 id="http2多路复用和http1-1的长连接keep-alive的区别" tabindex="-1">http2多路复用和http1.1的长连接keep-alive的区别 <a class="header-anchor" href="#http2多路复用和http1-1的长连接keep-alive的区别" aria-hidden="true">#</a></h3><p>长连接1个TCP连接同一时间只能处理一个请求 只能有一方发送数据，另一方接受数据。 多路复用是1个TCP同一时间处理多个请求</p><h3 id="为什么http1-1不能实现多路复用" tabindex="-1">为什么http1.1不能实现多路复用 <a class="header-anchor" href="#为什么http1-1不能实现多路复用" aria-hidden="true">#</a></h3><p>字符串文本分割解析，在响应时如果处理多个请求，不能知道属于哪个请求的响应</p><h3 id="在不改动-http-1-1-的语义、⽅法、状态码、uri-以及⾸部字段等等的情况下-http-2-是如何过渡到http1-1呢" tabindex="-1">在不改动 HTTP/1.1 的语义、⽅法、状态码、URI 以及⾸部字段等等的情况下, HTTP/2 是如何过渡到http1.1呢? <a class="header-anchor" href="#在不改动-http-1-1-的语义、⽅法、状态码、uri-以及⾸部字段等等的情况下-http-2-是如何过渡到http1-1呢" aria-hidden="true">#</a></h3><p>关键之⼀就是在应⽤层(HTTP/2)和传输层(TCP or UDP)之间增加⼀个⼆进制分帧层</p><h3 id="promise实现控制最大并发量，控制响应顺序" tabindex="-1">promise实现控制最大并发量，控制响应顺序 <a class="header-anchor" href="#promise实现控制最大并发量，控制响应顺序" aria-hidden="true">#</a></h3><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-hidden="true">#</a></h2><ul><li><a href="https://ye11ow.gitbooks.io/http2-explained/content/part2.html" target="_blank" rel="noopener noreferrer">http2-中文文档</a></li><li><a href="https://www.bilibili.com/video/BV1p541147LD" target="_blank" rel="noopener noreferrer">http2-视频</a></li></ul></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>介绍</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/http/http3" data-v-38ede35f><span class="text" data-v-38ede35f>http3</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"http_http2.md\":\"f913a313\",\"http_http3.md\":\"060f1a93\",\"http_http缓存.md\":\"31fc5d76\",\"index.md\":\"e233a088\",\"innermanage_内管前端工程.md\":\"e613f30e\",\"interview_js基础.md\":\"f3bc5865\",\"interview_todo.md\":\"199537bf\",\"interview__过.md\":\"865ff21e\",\"interview_前端面试之道.md\":\"ec1a40c2\",\"interview_各种题目01.md\":\"079c680b\",\"interview_手写系列-callbind.md\":\"12930746\",\"interview_手写系列-instanceof.md\":\"5ef6c309\",\"interview_手写系列-map和filter和reduce.md\":\"7d9d2352\",\"interview_手写系列-new原理.md\":\"a96cf990\",\"interview_手写系列-settime模拟setinterval.md\":\"e387ac1a\",\"interview_手写系列-发布订阅和观察者.md\":\"a516d630\",\"interview_手写系列-复杂axios.md\":\"ed7137b3\",\"interview_手写系列-复杂promise.md\":\"4e5735bb\",\"interview_手写系列-数组转树.md\":\"c01229aa\",\"interview_手写系列-深拷贝.md\":\"79f771f4\",\"interview_手写系列-防抖节流.md\":\"060f760c\",\"interview_算法01.md\":\"182a4137\",\"jiagou_monorepo.md\":\"51eb3439\",\"jiagou_从0到1构建符合标准的公共库.md\":\"99849ee2\",\"jiagou_切换主题方案.md\":\"501a1a5e\",\"jiagou_前端基础建设与架构30讲.md\":\"f7baf6ec\",\"jiagou_搭建组件库.md\":\"d9bc651d\",\"jiagou_深入babel.md\":\"9abe1423\",\"jiagou_自动生成按需导出目录.md\":\"5f601077\",\"jiagou_表单组件带校验功能.md\":\"d794d549\",\"js_object.entries.md\":\"3ba00128\",\"js_class和构造函数.md\":\"d5c78ad6\",\"js_dayformat正则的使用.md\":\"8abaaa7f\",\"js_luhn算法.md\":\"ffeffec6\",\"js_proxy.md\":\"a7b2ad3a\",\"js_优雅的class.md\":\"497ed7e9\",\"js_前端模块化.md\":\"ed11c518\",\"js_浏览器垃圾回收.md\":\"b6fa7d93\",\"js_深入babel.md\":\"92842df6\",\"js_闭包与垃圾回收.md\":\"bd9a10f4\",\"microfrontend_介绍.md\":\"9ff9f87d\",\"microfrontend_拟定微前端架构设计.md\":\"fccf143e\",\"microfrontend_架构思想.md\":\"748e5304\",\"node_cheetah-learn.md\":\"95e6fcd1\",\"node_cli相关学习.md\":\"c29bfdd7\",\"performance_serviceworker.md\":\"6f67fcf2\",\"performance_ssr.md\":\"0f412a14\",\"performance_慕课网web性能优化.md\":\"f53c24bc\",\"typescript_vue2加ts.md\":\"9d17aaa6\",\"vue_create-vue脚手架.md\":\"89f2fa24\",\"vue_esbuild使用.md\":\"7977b135\",\"vue_keep-alive原理.md\":\"ef31ebc9\",\"vue_vue-router实现原理.md\":\"6106cd66\",\"vue_模板编译.md\":\"50b03259\",\"vue_路由页面历史栈的处理.md\":\"8b4132c2\",\"vue_重学vue-01模板语法.md\":\"436fc3ef\",\"vue_重学vue-02数据驱动视图.md\":\"d89737de\",\"vue_重学vue-03render函数.md\":\"1cc2f4a1\",\"vue_重学vue-04内置指令.md\":\"59840a53\",\"vue_重学vue-05filter多余吗.md\":\"02057bf4\",\"vue_重学vue-06computer.md\":\"10c8a4d4\",\"vue_重学vue-07watch.md\":\"25d56e53\",\"vue_重学vue-08组件.md\":\"3d21f25c\",\"vue_重学vue-09生命周期.md\":\"786dacfb\",\"vue_重学vue-10ref是什么.md\":\"a29dd7e6\",\"vue_重学vue-11nexttick.md\":\"35043fa8\",\"vue_重学vue-8组件通信.md\":\"4845edc5\",\"vue_重学vue-vue.use.md\":\"cc4266d2\",\"vue_重学vue-动画内置组件.md\":\"04d4553c\",\"vue3_elementplus.md\":\"2f3aeef9\",\"vue3_入门.md\":\"33504c8d\",\"webcomponents_1. webcomponent介绍.md\":\"29a6407a\",\"webcomponents_2. customelements.md\":\"9e1088a3\",\"webpack_1.md\":\"7279a63f\",\"webpack__草稿.md\":\"39f16499\",\"webpack_实现一个自己的脚手架.md\":\"b4d5365f\",\"webpack_重学webpack-01打包工具的思考.md\":\"083571d8\",\"webpack_重学webpack-02模块化原理.md\":\"0650e76f\",\"webpack_重学webpack-03loader.md\":\"43789662\",\"webpack_重学webpack-04plugin.md\":\"73454000\",\"webpack_重学webpack-05hmr热更新.md\":\"007085b5\",\"week_202110-1.md\":\"ecb6af64\",\"week_202110-2.md\":\"59fce584\",\"week_202111-1.md\":\"7d3ac50a\",\"week__0todo.md\":\"d60b5fc0\",\"week_缓存工具方法思路.md\":\"13a83606\",\"work_ios小白条问题.md\":\"cf9e950f\"}")</script>
    <script type="module" async src="/assets/app.d95e124d.js"></script>
    
  </body>
</html>