<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>bin指令 | blog</title>
    <meta name="description" content="vue、js、nodejs等等的学习记录">
    <link rel="stylesheet" href="/assets/style.49eed234.css">
    <link rel="modulepreload" href="/assets/Home.ae65bc00.js">
    <link rel="modulepreload" href="/assets/app.d95e124d.js">
    <link rel="modulepreload" href="/assets/node_cheetah-learn.md.03f4cd07.lean.js">
    
    <meta name="twitter:title" content="bin指令 | blog">
  <meta property="og:title" content="bin指令 | blog">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="blog, back to home" data-v-675d8756 data-v-cc01ef16><!----> blog</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://gitee.com/hzh100" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>gitee <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://gitee.com/hzh100" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>gitee <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item"> 介绍</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/">介绍</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">http</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/http/http2">http2</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/http/http3">http3</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/http/http缓存">http缓存</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">innermanage</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/innermanage/内管前端工程">内管前端工程</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">interview</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/JS基础">JS基础</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/TODO">TODO</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/前端面试之道">前端面试之道</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/各种题目01">各种题目01</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-callbind">手写系列-callbind</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-instanceof">手写系列-instanceof</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-map和filter和reduce">手写系列-map和filter和reduce</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-new原理">手写系列-new原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-setTime模拟setInterval">手写系列-setTime模拟setInterval</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-发布订阅和观察者">手写系列-发布订阅和观察者</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-复杂axios">手写系列-复杂axios</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-复杂promise">手写系列-复杂promise</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-数组转树">手写系列-数组转树</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-深拷贝">手写系列-深拷贝</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-防抖节流">手写系列-防抖节流</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/算法01">算法01</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">jiagou</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/monorepo">monorepo</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/从0到1构建符合标准的公共库">从0到1构建符合标准的公共库</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/切换主题方案">切换主题方案</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/前端基础建设与架构30讲">前端基础建设与架构30讲</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/搭建组件库">搭建组件库</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/深入babel">深入babel</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/自动生成按需导出目录">自动生成按需导出目录</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/表单组件带校验功能">表单组件带校验功能</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">js</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/js/class和构造函数">class和构造函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/dayFormat正则的使用">dayFormat正则的使用</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/luhn算法">luhn算法</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/Object.entries">Object.entries</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/proxy">proxy</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/优雅的Class">优雅的Class</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/前端模块化">前端模块化</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/浏览器垃圾回收">浏览器垃圾回收</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/深入babel">深入babel</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/闭包与垃圾回收">闭包与垃圾回收</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">microFrontend</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/microFrontend/介绍">介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/microFrontend/拟定微前端架构设计">拟定微前端架构设计</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/microFrontend/架构思想">架构思想</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">node</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item active" href="/node/cheetah-learn">cheetah-learn</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#bin指令">bin指令</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dev">dev</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#devserver配置参数取项目目录">devServer配置参数取项目目录</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#利用devserver加载vconsole">利用devserver加载vconsole</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#利用webpack-plugin注入vconsole的依赖">利用webpack plugin注入vconsole的依赖</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#参考材料">参考材料</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#读配置打包commonmodule">读配置打包CommonModule</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#normalwebpackconf">normalWebpackConf</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/node/cli相关学习">cli相关学习</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">performance</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/performance/serviceWorker">serviceWorker</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/performance/ssr">ssr</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/performance/慕课网web性能优化">慕课网web性能优化</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">typescript</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/typescript/vue2加ts">vue2加ts</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">vue</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/create-vue脚手架">create-vue脚手架</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/esbuild使用">esbuild使用</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/keep-alive原理">keep-alive原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/vue-router实现原理">vue-router实现原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/模板编译">模板编译</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/路由页面历史栈的处理">路由页面历史栈的处理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-01模板语法">重学vue-01模板语法</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-02数据驱动视图">重学vue-02数据驱动视图</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-03render函数">重学vue-03render函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-04内置指令">重学vue-04内置指令</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-05filter多余吗">重学vue-05filter多余吗</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-06computer">重学vue-06computer</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-07watch">重学vue-07watch</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-08组件">重学vue-08组件</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-09生命周期">重学vue-09生命周期</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-10ref是什么">重学vue-10ref是什么</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-11nextTick">重学vue-11nextTick</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-8组件通信">重学vue-8组件通信</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-vue.use">重学vue-vue.use</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-动画内置组件">重学vue-动画内置组件</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">vue3</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue3/elementPlus">elementPlus</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue3/入门">入门</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">webComponents</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/webComponents/1. webComponent介绍">1. webComponent介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webComponents/2. customElements">2. customElements</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">webpack</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/1">1</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/实现一个自己的脚手架">实现一个自己的脚手架</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-01打包工具的思考">重学webpack-01打包工具的思考</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-02模块化原理">重学webpack-02模块化原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-03loader">重学webpack-03loader</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-04plugin">重学webpack-04plugin</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-05HMR热更新">重学webpack-05HMR热更新</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">week</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/week/202110-1">202110-1</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/week/202110-2">202110-2</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/week/202111-1">202111-1</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/week/缓存工具方法思路">缓存工具方法思路</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">work</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/work/ios小白条问题">ios小白条问题</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><blockquote><p>列表架构学习</p></blockquote><p>👇 封装的依赖库</p><div class="language-json"><pre><code><span class="token punctuation">{</span>
  <span class="token property">&quot;@ynet/ynet-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:npm_modules/ynet-cli&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;@ynet/ynet-spa-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:npm_modules/ynet-spa-cli&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;@ynet/ynet-bridge&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:npm_modules/ynet-bridge&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;@ynet/ynet-spa-bridge&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:npm_modules/ynet-spa-bridge&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;@ynet/ynet-components&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:npm_modules/ynet-components&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;@ynet/ynet-ui-floor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:npm_modules/ynet-ui-floor&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;@ynet/ynet-template-view&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:npm_modules/ynet-template-view&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;@ynet/ynet-templateframe&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:npm_modules/ynet-templateframe&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;@ynet/fastclick&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:npm_modules/fastclick&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>👇 入口</p><div class="language-json"><pre><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-dev --env=dev&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dev:mock&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-dev --env=dev --mock&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;common:develop&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-common --env=develop&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;common:uat&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-common --env=uat&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;common:poc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-common --env=poc&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;build:develop&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-bundle --env=develop&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;build:uat&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-bundle --env=uat&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;build:poc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-bundle --env=poc&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;zip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-zips&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;source&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-sourceZips&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;clean&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rimraf dist&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;clean:node&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rimraf node_modules&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;releaseconfig&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ynet-releaseConf&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint --ext .js,.vue src/modules&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;lint:fix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint --ext .js,.vue src/modules --fix&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;init-page&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node build/init-page.js -p&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>指令分为</p><ul><li>dev工具 -- ynet-dev</li><li>common工具 -- ynet-common</li><li>build工具 -- ynet-build</li><li>zip工具 -- ynet-zip</li><li>clean工具 -- node</li></ul><p>指令由<code>npx</code>执行，即执行项目 <code>node_modules</code> 下的 <code>bin</code> 指令 并不是对应一个指令对应一个依赖库</p><p>bin指令怎么找</p><h2 id="bin指令" tabindex="-1">bin指令 <a class="header-anchor" href="#bin指令" aria-hidden="true">#</a></h2><blockquote><p>依赖库的 <code>package.json</code> bin项用来指定各个内部命令对应的可执行文件的位置</p></blockquote><p>常规的安装项目内依赖,如果依赖package.json中配置bin 那将在node_modules下的.bin下生成映射 bin的key映射value的目录</p><p>安装一个myNpm的依赖，通过<code>node node_modules/myNpm/entry/main.js</code>执行 映射之后就可以通过<code>node node_modules/.bin/myNpm</code> 执行 可以看到，映射之后还是需要指定到node_modules下的bin来执行</p><p>我们想要让指令一步到位直接知道bin的key就是一段node指令,需要给执行文件头添加一段注释</p><div class="language-js"><pre><code><span class="token hashbang comment">#!/usr/bin/env node</span>

<span class="token comment">// dosometing...</span>
</code></pre></div><p>脚本的第一行通常是指定解释器，即这个脚本必须通过什么解释器执行。这一行以#!字符开头，这个字符称为 Shebang，所以这一行就叫做 Shebang 行。</p><p>#!后面就是脚本解释器的位置，Bash 脚本的解释器一般是/bin/sh或/bin/bash</p><p>#!/usr/bin/env xxx 这个语法的意思是，让 Shell 查找$PATH环境变量里面第一个匹配的NAME。</p><p>因此创建自定义指令</p><ul><li>安装的依赖package.json里有bin指定</li><li>依赖是项目通过npm安装到node_modules，或者项目package.json指定依赖是目录下包</li></ul><p>指定依赖是其他目录，要求目录下必须有package.json</p><div class="language-json"><pre><code><span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;antd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ant-design/ant-design#4.0.0-alpha.8&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;axios&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.2.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;test-js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:../test&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;test2-js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://cdn.com/test2-js.tar.gz&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;core-js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.1.5&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p><code>依赖包名:VERSION</code> VERSION 是一个遵循 SemVer 规范的版本号配置， npm install 时将到 npm 服务器下载符合指定版本范围的包。</p></li><li><p><code>依赖包名:DWONLOAD_URL</code> DWONLOAD_URL 是一个可下载的 tarball 压缩包地址，模块安装时会将这个 .tar 下载并安装到本地。</p></li><li><p><code>依赖包名:LOCAL_PATH</code> LOCAL_PATH 是一个本地的依赖包路径，例如 file:../pacakges/pkgName。适用于你在本地测试一个 npm 包，不应该将这种方法应用于线上。</p></li><li><p><code>依赖包名:GITHUB_URL</code> GITHUB_URL 即 github 的 username/modulename 的写法，例如：ant-design/ant-design，你还可以在后面指定 tag 和 commit id。</p></li><li><p><code>依赖包名:GIT_URL</code> GIT_URL 即我们平时 clone 代码库的 git url</p></li></ul><p>现在假设我要创建一个自己的cli依赖 在已有工程里怎么做调试，相关依赖是装到工程的node_modules里 但是cli的package.json也要记录相关依赖</p><p>还是说我应该独立创建并调试好依赖，再移到工程里，不能在工程里调试cli依赖</p><p>在 <code>ynet-cli</code> 的 <code>package.json</code> 中有一段 <code>bin</code> 配置</p><div class="language-json"><pre><code><span class="token property">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;ynet-dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bin/build.dev.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ynet-common&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bin/build.common.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ynet-bundle&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bin/build.prod.js&quot;</span><span class="token punctuation">,</span>
  
  <span class="token property">&quot;ynet-zips&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bin/build.zips.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ynet-releaseConf&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bin/build.release.config.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ynet-sourceZips&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bin/build.source.zip.js&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>相当于 <code>dev</code> 和 <code>build</code> 走不同的脚本，类似于 <code>node build/dev.js</code><code>node build/build.js</code></p><p>关于<a href="https://segmentfault.com/a/1190000021305625" target="_blank" rel="noopener noreferrer">前端工程化 - 剖析npm的包管理机制</a></p><h2 id="dev" tabindex="-1">dev <a class="header-anchor" href="#dev" aria-hidden="true">#</a></h2><blockquote><p><code>package.json</code> 中的参数支持 <code>--env=</code> 、 <code>--mock</code>、<code>--debug</code>、<code>--platform=</code></p></blockquote><ul><li>参数(仅用于业务包) <code>for example: npm run ynet-bundle demo happy --env=uat --platform=weixing --debug</code></li><li>注意 <code>所有非--开头的参数视为需要构建的离线包，多个bundle空隔分开，不传时视为构建全部</code></li></ul><h3 id="devserver配置参数取项目目录" tabindex="-1">devServer配置参数取项目目录 <a class="header-anchor" href="#devserver配置参数取项目目录" aria-hidden="true">#</a></h3><p><a href="./cli相关学习.html#配置参数默认取工程目录">配置参数默认取工程目录</a></p><h3 id="利用devserver加载vconsole" tabindex="-1">利用devserver加载vconsole <a class="header-anchor" href="#利用devserver加载vconsole" aria-hidden="true">#</a></h3><blockquote><p>利用 <code>devserver</code> 加载 <code>vconsole</code> ，而不是通过运行时项目去加在 <code>vconsole</code></p></blockquote><p>加载vconsole的方式</p><ul><li>html模版中通过<code>&lt;script src&gt;</code>加载</li><li>入口js中通过import加载，被webpack编译为<code>webpack.__require</code></li><li><code>devServer</code>启动的<code>node静态服务器</code>去发起get请求，这个get请求的资源要和<code>&lt;srcipt&gt;</code>的资源一样是挂在<code>window</code>下才行</li><li><code>webpack plugin</code> 往工程入口 <code>chunk</code> 中注入资源引用</li></ul><div class="language-js"><pre><code><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebpackDevServer</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> devServer<span class="token punctuation">)</span>
<span class="token comment">// server.app是node静态服务器 express</span>
server<span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/vconsole.min.js&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> env<span class="token punctuation">,</span> debug <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>command
  <span class="token keyword">if</span><span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">&#39;dev&#39;</span> <span class="token operator">||</span> debug<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> sourcePath <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;vconsole&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> source <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>sourcePath<span class="token punctuation">)</span>
    source <span class="token operator">+=</span> <span class="token string">&#39;;window.VConsole = new VConsole()&#39;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>require.resolve</code>跟<code>require</code>的区别 都是写资源名不写路径时按node_modules的package.json中main目录猜测资源位置</p><ul><li><code>require.resolve</code>,返回资源绝对路径,是webpack提供的CJS模块化拓展方法,在纯node环境并不支持</li><li><code>require</code>,返回资源内容, node的CJS模块化，</li></ul><p><code>require.resolve(&#39;vconsole&#39;)</code>,就会返回node_modules下的vconsole资源目录 这里不直接使用require是因为要用fs文件系统读取并修改文件内容,因此需要源文件字符串，而不能是模块抛出的内容？ 不修改文件内容而是自己写<code>new Vconsole()</code>的写法也是可以的吧</p><h3 id="利用webpack-plugin注入vconsole的依赖" tabindex="-1">利用webpack plugin注入vconsole的依赖 <a class="header-anchor" href="#利用webpack-plugin注入vconsole的依赖" aria-hidden="true">#</a></h3><blockquote><p>TODO: 问题是怎么知道往那个chunk中注入vconsole？</p></blockquote><p>单页的话只往入口注入 多页要往多入口注入</p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../helper&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> OriginalSource <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack-sources&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Chunk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack/lib/Chunk&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>env <span class="token operator">=</span> env
  <span class="token punctuation">}</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>env <span class="token operator">!==</span> <span class="token string">&#39;dev&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token comment">// 读取并修改资源内容</span>
    <span class="token keyword">const</span> vc <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;node_modules/vconsole/dist/vconsole.min.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> sourceCode <span class="token operator">=</span> vc <span class="token operator">+</span> <span class="token string">&#39;;window.VConsole = new VConsole()&#39;</span>
    <span class="token keyword">const</span> fileName <span class="token operator">=</span> <span class="token string">&#39;vconsole.min.js&#39;</span>

    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#39;compilation&#39;</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    	compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>additionalAssets<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&#39;additionalAssets&#39;</span><span class="token punctuation">,</span> <span class="token parameter">next</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// additionalAssets的钩子上添加资源new chunk</span>
        compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>fileName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OriginalSource</span><span class="token punctuation">(</span>sourceCode<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
        <span class="token keyword">const</span> chunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&#39;vconsole.min&#39;</span><span class="token punctuation">)</span>
        chunk<span class="token punctuation">.</span>files <span class="token operator">=</span> <span class="token punctuation">[</span>fileName<span class="token punctuation">]</span>
        chunk<span class="token punctuation">.</span>ids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        compilation<span class="token punctuation">.</span>chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="参考材料" tabindex="-1">参考材料 <a class="header-anchor" href="#参考材料" aria-hidden="true">#</a></h2><ul><li><a href="https://segmentfault.com/a/1190000021305625" target="_blank" rel="noopener noreferrer">前端工程化 - 剖析npm的包管理机制</a></li></ul><p>common</p><div class="language-js"><pre><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resolveLoader</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/dist&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].js&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">libraryExport</span><span class="token operator">:</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">libraryTarget</span><span class="token operator">:</span> <span class="token string">&#39;umd&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token string">&#39;cssBundle&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">noParse</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">cssBundle</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/src/common/cssBundle&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span>LodashModuleReplacementPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      VueLoaderPlugin <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>HotModuleReplacementPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>DefinePlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>DefinePlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>DefinePlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>ExtractTextPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resolveLoader</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/dist&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].js&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">libraryExport</span><span class="token operator">:</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">libraryTarget</span><span class="token operator">:</span> <span class="token string">&#39;umd&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token string">&#39;initBundle&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">noParse</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">initBundle</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/src/common/initBundle&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span>LodashModuleReplacementPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      VueLoaderPlugin <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>HotModuleReplacementPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>DefinePlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>DefinePlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>DefinePlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>ExtractTextPlugin<span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>normal</p><div class="language-js"><pre><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">runtimeChunk</span><span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resolveLoader</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/dist&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].[hash:8].js&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">sourceMapFilename</span><span class="token operator">:</span> <span class="token string">&#39;[name].js.map&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">vue</span><span class="token operator">:</span> <span class="token string">&#39;initBundle(&quot;vue&quot;)&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">vuex</span><span class="token operator">:</span> <span class="token string">&#39;initBundle(&quot;vuex&quot;)&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">fastclick</span><span class="token operator">:</span> <span class="token string">&#39;initBundle(&quot;fastclick&quot;)&#39;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;vue-init&#39;</span><span class="token operator">:</span> <span class="token string">&#39;initBundle(&quot;vue-init&quot;)&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">noParse</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&#39;demo/demo/button&#39;</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/src/modules/demo/demo/button/main&#39;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;demo/demo/viewbox&#39;</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/src/modules/demo/demo/viewbox/main&#39;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;demo/demo/countdown&#39;</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/src/modules/demo/demo/countdown/main&#39;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;demo/demo/swiperout&#39;</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/src/modules/demo/demo/swiperout/main&#39;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;demo/demo/circle&#39;</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/src/modules/demo/demo/circle/main&#39;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;demo/demo/pay&#39;</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/src/modules/demo/demo/pay/main&#39;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;demo/demo/indexbar&#39;</span><span class="token operator">:</span> <span class="token string">&#39;/Users/luojinan/Desktop/code/Cheetah_Mobile/src/modules/demo/demo/indexbar/main&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span>HtmlWebpackPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>HtmlWebpackPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>HtmlWebpackPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>HtmlWebpackPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>HtmlWebpackPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>HtmlWebpackPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>HtmlWebpackPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>LodashModuleReplacementPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      VueLoaderPlugin <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>HotModuleReplacementPlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>DefinePlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>DefinePlugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h2 id="读配置打包commonmodule" tabindex="-1">读配置打包CommonModule <a class="header-anchor" href="#读配置打包commonmodule" aria-hidden="true">#</a></h2><blockquote><p>输出2个webpack进程配置</p><ul><li>css</li><li>corejs</li></ul></blockquote><p>读取配置文件 <code>src/common/conf.json</code></p><div class="language-json"><pre><code><span class="token punctuation">{</span>
  <span class="token property">&quot;cssBundle&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;css&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;initBundle&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;exports&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vuex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fastclick&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue-init&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js"><pre><code><span class="token keyword">this</span><span class="token punctuation">.</span>commonMap <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span>BaseModules<span class="token punctuation">.</span>appConf<span class="token punctuation">.</span>commonModules<span class="token punctuation">,</span> <span class="token string">&#39;conf&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><code>BaseModules.appConf</code> 是根据项目配置和内置配置合并后的配置，关于<a href="./cli相关学习.html#配置参数默认取工程目录">配置参数默认取工程目录</a><code>commonModules</code> 在内置配置设置为 <code>src/common</code></p><p>因此<code>resolve(commonModules, &#39;conf&#39;</code> 返回完整地址绝对路径 node环境 <code>require(&#39;xx.json&#39;)</code> 可以输出成对象</p><p>遍历对象使用key生成 bundleName 👆 由配置文件，确定要单独打包的模块为js和css</p><p>用一份 <code>webpack</code> 的 <code>baseConfig</code> 再自定义一些内容的形式来配置 <code>webpack</code> (更好的复用 <code>baseConfig</code> )</p><p><code>baseConfig</code> 主要帮助根据 <code>dev</code> 和 <code>prod</code> 环境区分出基本通用的配置</p><div class="language-js"><pre><code><span class="token keyword">function</span> <span class="token function">getBastConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> env <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>command
  <span class="token keyword">const</span> webpackEnvConf <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../webpackConf/webpack.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>env <span class="token operator">==</span> <span class="token string">&#39;dev&#39;</span> <span class="token operator">?</span> <span class="token string">&#39;dev&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;prod&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  	webpackEnvConf<span class="token punctuation">,</span> <span class="token comment">// devConfig ro prodConfig</span>
  	<span class="token punctuation">{</span>
      <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userEnvConf<span class="token punctuation">.</span>envConfig<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js"><pre><code><span class="token comment">// webpack.base</span>
<span class="token keyword">const</span> VueLoaderPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;vue-loader/lib/plugin&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> LodashModuleReplacementPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;lodash-webpack-plugin&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../helper&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> AppConf <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../lib/AppConfig&#39;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">vendors</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;initial&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;vendor&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">runtimeChunk</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;manifest&#39;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">resolveLoader</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;node_modules&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;../loader&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;.js&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.vue&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.json&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.scss&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.less&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.css&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.styl&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.stylus&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&#39;@&#39;</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>AppConf<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string-property property">&#39;vue$&#39;</span><span class="token operator">:</span> <span class="token string">&#39;vue/dist/vue.runtime.min.js&#39;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">LodashModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js"><pre><code><span class="token comment">// webpack.dev</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack-merge&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../helper&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpackBaseConf <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./webpack.base&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> AppConf <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../lib/AppConfig&#39;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>webpackBaseConf<span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>AppConf<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].[hash:8].js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sourceMapFilename</span><span class="token operator">:</span> <span class="token string">&#39;[name].js.map&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>可以看到通用webpack配置是缺少loader的 因此外部合并配置还需要自定义</p><ul><li>entry</li><li>output</li><li>loader</li><li>其他视情况定义</li></ul><p>css和js都是打成一个文件，不需要分包,所以需要覆盖掉通用配置的分包配置</p><div class="language-js"><pre><code><span class="token function">_createCommonWebpackConf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> env <span class="token punctuation">}</span> <span class="token operator">=</span> BaseModules<span class="token punctuation">.</span>command
  <span class="token keyword">const</span> <span class="token punctuation">{</span> output<span class="token punctuation">,</span> alias <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> BaseModules<span class="token punctuation">.</span>appConf
  <span class="token keyword">const</span> <span class="token punctuation">{</span> plugins<span class="token punctuation">,</span> <span class="token operator">...</span>other <span class="token punctuation">}</span> <span class="token operator">=</span> BaseModules<span class="token punctuation">.</span>baseWebackConf

  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>commonMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>commonMap<span class="token punctuation">[</span>key<span class="token punctuation">]</span>

    <span class="token keyword">const</span> conf <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      other<span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token literal-property property">noParse</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.min\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">&#39;CommonLoaders&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token operator">...</span>plugins<span class="token punctuation">,</span>
          <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string-property property">&#39;bundleStat&#39;</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>BaseModules<span class="token punctuation">.</span><span class="token function">createBundleStat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string-property property">&#39;bundleId&#39;</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>BaseModules<span class="token punctuation">.</span><span class="token function">createAppList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].css&#39;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">path</span><span class="token operator">:</span> env <span class="token operator">===</span> <span class="token string">&#39;dev&#39;</span> <span class="token operator">?</span> <span class="token function">resolve</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> BaseModules<span class="token punctuation">.</span>location<span class="token punctuation">.</span>base<span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].js&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">libraryExport</span><span class="token operator">:</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">libraryTarget</span><span class="token operator">:</span> <span class="token string">&#39;umd&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">library</span><span class="token operator">:</span> key
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">extensions</span><span class="token operator">:</span> other<span class="token punctuation">.</span>resolve<span class="token punctuation">.</span>extensions<span class="token punctuation">,</span>
          <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&#39;@m&#39;</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>BaseModules<span class="token punctuation">.</span>appConf<span class="token punctuation">.</span>commonModules<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span>alias<span class="token punctuation">,</span>
            <span class="token operator">...</span>other<span class="token punctuation">.</span>resolve<span class="token punctuation">.</span>alias
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token comment">// 👆其他webpack配置公用</span>
    <span class="token comment">// entry属性取决于配置的key</span>
    conf<span class="token punctuation">.</span>entry<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_transformFilename</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>output <span class="token operator">||</span> key<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">resolve</span><span class="token punctuation">(</span>BaseModules<span class="token punctuation">.</span>appConf<span class="token punctuation">.</span>commonModules<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
    <span class="token comment">// value对象的type如果是css则push一个plugin</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>type <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">&#39;css&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span> conf<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">replaceChunk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token comment">// 过滤非css的资源</span>
    result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>CSS里的图片资源？</p><h2 id="normalwebpackconf" tabindex="-1">normalWebpackConf <a class="header-anchor" href="#normalwebpackconf" aria-hidden="true">#</a></h2></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/microFrontend/架构思想" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>架构思想</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/node/cli相关学习" data-v-38ede35f><span class="text" data-v-38ede35f>cli相关学习</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"http_http2.md\":\"61f372f8\",\"http_http3.md\":\"f4eae4a7\",\"http_http缓存.md\":\"90dfc416\",\"index.md\":\"7cd664a4\",\"innermanage_内管前端工程.md\":\"2e5b87fc\",\"interview_js基础.md\":\"f3b76f1b\",\"interview_todo.md\":\"a4bea80d\",\"interview__过.md\":\"ad46898e\",\"interview_前端面试之道.md\":\"29e10a7b\",\"interview_各种题目01.md\":\"336c3f0f\",\"interview_手写系列-callbind.md\":\"1a27c36e\",\"interview_手写系列-instanceof.md\":\"5a89338b\",\"interview_手写系列-map和filter和reduce.md\":\"4b19ddd8\",\"interview_手写系列-new原理.md\":\"bb803aa9\",\"interview_手写系列-settime模拟setinterval.md\":\"f315b518\",\"interview_手写系列-发布订阅和观察者.md\":\"f6b28385\",\"interview_手写系列-复杂axios.md\":\"fafdf239\",\"interview_手写系列-复杂promise.md\":\"41f7e308\",\"interview_手写系列-数组转树.md\":\"75c9efc8\",\"interview_手写系列-深拷贝.md\":\"3d378cc3\",\"interview_手写系列-防抖节流.md\":\"621af863\",\"interview_算法01.md\":\"d9c4b61a\",\"jiagou_monorepo.md\":\"725693ea\",\"jiagou_从0到1构建符合标准的公共库.md\":\"4db26899\",\"jiagou_切换主题方案.md\":\"1c6f7cc6\",\"jiagou_前端基础建设与架构30讲.md\":\"545c2f4d\",\"jiagou_搭建组件库.md\":\"75b6105a\",\"jiagou_深入babel.md\":\"98134c12\",\"jiagou_自动生成按需导出目录.md\":\"a0a99e5b\",\"jiagou_表单组件带校验功能.md\":\"037e52c3\",\"js_object.entries.md\":\"d7ef83a2\",\"js_class和构造函数.md\":\"e1c68545\",\"js_dayformat正则的使用.md\":\"da3c8fb2\",\"js_luhn算法.md\":\"1a42337b\",\"js_proxy.md\":\"6ff1ec19\",\"js_优雅的class.md\":\"3df6be82\",\"js_前端模块化.md\":\"9e7f6ead\",\"js_浏览器垃圾回收.md\":\"e21a3e55\",\"js_深入babel.md\":\"52722ee7\",\"js_闭包与垃圾回收.md\":\"749b2ff1\",\"microfrontend_介绍.md\":\"580a3921\",\"microfrontend_拟定微前端架构设计.md\":\"ff7f9528\",\"microfrontend_架构思想.md\":\"08afff96\",\"node_cheetah-learn.md\":\"03f4cd07\",\"node_cli相关学习.md\":\"5b8b30ed\",\"performance_serviceworker.md\":\"8daffe4c\",\"performance_ssr.md\":\"a4ce6081\",\"performance_慕课网web性能优化.md\":\"b9f642c2\",\"typescript_vue2加ts.md\":\"4dfc1521\",\"vue_create-vue脚手架.md\":\"0eba574d\",\"vue_esbuild使用.md\":\"e068bb0d\",\"vue_keep-alive原理.md\":\"44c46c5f\",\"vue_vue-router实现原理.md\":\"1d2621c4\",\"vue_模板编译.md\":\"482e2dc9\",\"vue_路由页面历史栈的处理.md\":\"f827e2a6\",\"vue_重学vue-01模板语法.md\":\"69d88a08\",\"vue_重学vue-02数据驱动视图.md\":\"c681bf73\",\"vue_重学vue-03render函数.md\":\"477b8cdc\",\"vue_重学vue-04内置指令.md\":\"d05b23f6\",\"vue_重学vue-05filter多余吗.md\":\"583eb11a\",\"vue_重学vue-06computer.md\":\"2085b276\",\"vue_重学vue-07watch.md\":\"915b128f\",\"vue_重学vue-08组件.md\":\"1a9f134f\",\"vue_重学vue-09生命周期.md\":\"a715abeb\",\"vue_重学vue-10ref是什么.md\":\"8043a67e\",\"vue_重学vue-11nexttick.md\":\"c1eba6cc\",\"vue_重学vue-8组件通信.md\":\"fe312913\",\"vue_重学vue-vue.use.md\":\"2adddb6d\",\"vue_重学vue-动画内置组件.md\":\"f35266d9\",\"vue3_elementplus.md\":\"474cd264\",\"vue3_入门.md\":\"3cbb2de8\",\"webcomponents_1. webcomponent介绍.md\":\"6dd880b3\",\"webcomponents_2. customelements.md\":\"e890e63a\",\"webpack_1.md\":\"19710796\",\"webpack__草稿.md\":\"a4521525\",\"webpack_实现一个自己的脚手架.md\":\"3a0dcb1e\",\"webpack_重学webpack-01打包工具的思考.md\":\"dc8f4b90\",\"webpack_重学webpack-02模块化原理.md\":\"be9e501e\",\"webpack_重学webpack-03loader.md\":\"34f09632\",\"webpack_重学webpack-04plugin.md\":\"bc5707c3\",\"webpack_重学webpack-05hmr热更新.md\":\"9368db44\",\"week_202110-1.md\":\"66b9ab24\",\"week_202110-2.md\":\"5bcee2e2\",\"week_202111-1.md\":\"72fb7b6d\",\"week__0todo.md\":\"271b539a\",\"week_缓存工具方法思路.md\":\"fdb57aa6\",\"work_ios小白条问题.md\":\"5d8a3aac\"}")</script>
    <script type="module" async src="/assets/app.d95e124d.js"></script>
    
  </body>
</html>