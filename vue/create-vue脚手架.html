<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>create-vue脚手架 | blog</title>
    <meta name="description" content="vue、js、nodejs等等的学习记录">
    <link rel="stylesheet" href="/assets/style.49eed234.css">
    <link rel="modulepreload" href="/assets/Home.ae65bc00.js">
    <link rel="modulepreload" href="/assets/app.d95e124d.js">
    <link rel="modulepreload" href="/assets/vue_create-vue脚手架.md.89f2fa24.lean.js">
    
    <meta name="twitter:title" content="create-vue脚手架 | blog">
  <meta property="og:title" content="create-vue脚手架 | blog">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="blog, back to home" data-v-675d8756 data-v-cc01ef16><!----> blog</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://gitee.com/hzh100" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>gitee <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://gitee.com/hzh100" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>gitee <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item"> 介绍</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/">介绍</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">http</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/http/http2">http2</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/http/http3">http3</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/http/http缓存">http缓存</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">innermanage</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/innermanage/内管前端工程">内管前端工程</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">interview</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/JS基础">JS基础</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/TODO">TODO</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/前端面试之道">前端面试之道</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/各种题目01">各种题目01</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-callbind">手写系列-callbind</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-instanceof">手写系列-instanceof</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-map和filter和reduce">手写系列-map和filter和reduce</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-new原理">手写系列-new原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-setTime模拟setInterval">手写系列-setTime模拟setInterval</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-发布订阅和观察者">手写系列-发布订阅和观察者</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-复杂axios">手写系列-复杂axios</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-复杂promise">手写系列-复杂promise</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-数组转树">手写系列-数组转树</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-深拷贝">手写系列-深拷贝</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/手写系列-防抖节流">手写系列-防抖节流</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/interview/算法01">算法01</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">jiagou</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/monorepo">monorepo</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/从0到1构建符合标准的公共库">从0到1构建符合标准的公共库</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/切换主题方案">切换主题方案</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/前端基础建设与架构30讲">前端基础建设与架构30讲</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/搭建组件库">搭建组件库</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/深入babel">深入babel</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/自动生成按需导出目录">自动生成按需导出目录</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/jiagou/表单组件带校验功能">表单组件带校验功能</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">js</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/js/class和构造函数">class和构造函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/dayFormat正则的使用">dayFormat正则的使用</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/luhn算法">luhn算法</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/Object.entries">Object.entries</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/proxy">proxy</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/优雅的Class">优雅的Class</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/前端模块化">前端模块化</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/浏览器垃圾回收">浏览器垃圾回收</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/深入babel">深入babel</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/闭包与垃圾回收">闭包与垃圾回收</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">microFrontend</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/microFrontend/介绍">介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/microFrontend/拟定微前端架构设计">拟定微前端架构设计</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/microFrontend/架构思想">架构思想</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">node</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/node/cheetah-learn">cheetah-learn</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/node/cli相关学习">cli相关学习</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">performance</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/performance/serviceWorker">serviceWorker</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/performance/ssr">ssr</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/performance/慕课网web性能优化">慕课网web性能优化</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">typescript</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/typescript/vue2加ts">vue2加ts</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">vue</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item active" href="/vue/create-vue脚手架">create-vue脚手架</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#create-vue脚手架">create-vue脚手架</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#create-vue真正强大的地方在于他创建项目的速度">create-vue真正强大的地方在于他创建项目的速度</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#实现步骤分析">实现步骤分析</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#一、初始化项目">一、初始化项目</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#二、实现问答式配置">二、实现问答式配置</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#三、兼容指令配置-跳过问答">三、兼容指令配置,跳过问答</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#项目名重复-询问覆盖">项目名重复,询问覆盖</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#根据问答数据生成模版文件">根据问答数据生成模版文件</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#替换js模版成ts">替换js模版成ts</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#从0编写生成readme文件">从0编写生成readme文件</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#git-clone项目把提交记录也保留下来">git clone项目把提交记录也保留下来</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#减少了删除文件夹依赖rimraf">减少了删除文件夹依赖rimraf</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/esbuild使用">esbuild使用</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/keep-alive原理">keep-alive原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/vue-router实现原理">vue-router实现原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/模板编译">模板编译</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/路由页面历史栈的处理">路由页面历史栈的处理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-01模板语法">重学vue-01模板语法</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-02数据驱动视图">重学vue-02数据驱动视图</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-03render函数">重学vue-03render函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-04内置指令">重学vue-04内置指令</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-05filter多余吗">重学vue-05filter多余吗</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-06computer">重学vue-06computer</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-07watch">重学vue-07watch</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-08组件">重学vue-08组件</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-09生命周期">重学vue-09生命周期</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-10ref是什么">重学vue-10ref是什么</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-11nextTick">重学vue-11nextTick</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-8组件通信">重学vue-8组件通信</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-vue.use">重学vue-vue.use</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/重学vue-动画内置组件">重学vue-动画内置组件</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">vue3</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue3/elementPlus">elementPlus</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue3/入门">入门</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">webComponents</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/webComponents/1. webComponent介绍">1. webComponent介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webComponents/2. customElements">2. customElements</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">webpack</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/1">1</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/实现一个自己的脚手架">实现一个自己的脚手架</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-01打包工具的思考">重学webpack-01打包工具的思考</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-02模块化原理">重学webpack-02模块化原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-03loader">重学webpack-03loader</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-04plugin">重学webpack-04plugin</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/webpack/重学webpack-05HMR热更新">重学webpack-05HMR热更新</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">week</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/week/202110-1">202110-1</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/week/202110-2">202110-2</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/week/202111-1">202111-1</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/week/缓存工具方法思路">缓存工具方法思路</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">work</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/work/ios小白条问题">ios小白条问题</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><p><div class="table-of-contents"><ul><li><a href="#create-vue脚手架">create-vue脚手架</a></li><li><a href="#create-vue真正强大的地方在于他创建项目的速度">create-vue真正强大的地方在于他创建项目的速度</a></li><li><a href="#实现步骤分析">实现步骤分析</a></li><li><a href="#一、初始化项目">一、初始化项目</a></li><li><a href="#二、实现问答式配置">二、实现问答式配置</a></li><li><a href="#三、兼容指令配置-跳过问答">三、兼容指令配置,跳过问答</a></li><li><a href="#项目名重复-询问覆盖">项目名重复,询问覆盖</a></li><li><a href="#根据问答数据生成模版文件">根据问答数据生成模版文件</a></li><li><a href="#替换js模版成ts">替换js模版成ts</a></li><li><a href="#从0编写生成readme文件">从0编写生成readme文件</a></li><li><a href="#git-clone项目把提交记录也保留下来">git clone项目把提交记录也保留下来</a></li><li><a href="#减少了删除文件夹依赖rimraf">减少了删除文件夹依赖rimraf</a></li></ul></div></p><h2 id="create-vue脚手架" tabindex="-1">create-vue脚手架 <a class="header-anchor" href="#create-vue脚手架" aria-hidden="true">#</a></h2><blockquote><p>参考文章<a href="https://juejin.cn/post/7018344866811740173" target="_blank" rel="noopener noreferrer">Vue 团队公开快如闪电的全新脚手架工具 create-vue，未来将替代 Vue-CLI，才300余行代码</a></p></blockquote><div class="language-bash"><pre><code><span class="token function">npm</span> init vue@next
</code></pre></div><p>在习惯里，npm的脚手架依赖库工具都是通过全局安装依赖后，使用该库的指令进行搭建 如⬇️ vue-cli脚手架</p><div class="language-bash"><pre><code><span class="token function">npm</span> i -g @vue/cli
vue create hello-world
</code></pre></div><p>而<code>npm init</code>则是给项目路径初始化出<code>package.json</code>文件，初始化项目目录的指令</p><p>为什么<code>npm init vue@next</code> 就可以安装脚手架依赖并运行脚手架搭建指令呢？ 注意这里的<code>npm init xx</code> 不是安装依赖的指令<code>npm i xx</code> = <code>npm install xx</code></p><p>npm init 用法：</p><div class="language-bash"><pre><code><span class="token function">npm</span> init <span class="token punctuation">[</span>--force<span class="token operator">|</span>-f<span class="token operator">|</span>--yes<span class="token operator">|</span>-y<span class="token operator">|</span>--scope<span class="token punctuation">]</span>
<span class="token function">npm</span> init <span class="token operator">&lt;</span>@scope<span class="token operator">&gt;</span> <span class="token punctuation">(</span>same as <span class="token variable"><span class="token variable">`</span>npx <span class="token operator">&lt;</span>@scope<span class="token operator">&gt;</span>/create<span class="token variable">`</span></span><span class="token punctuation">)</span>
<span class="token function">npm</span> init <span class="token punctuation">[</span><span class="token operator">&lt;</span>@scope<span class="token operator">&gt;</span>/<span class="token punctuation">]</span><span class="token operator">&lt;</span>name<span class="token operator">&gt;</span> <span class="token punctuation">(</span>same as <span class="token variable"><span class="token variable">`</span>npx <span class="token punctuation">[</span><span class="token operator">&lt;</span>@scope<span class="token operator">&gt;</span>/<span class="token punctuation">]</span>create-<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token variable">`</span></span><span class="token punctuation">)</span>
</code></pre></div><p>npm init xxx -&gt; npx create-xxx npm init @xxx -&gt; npx @xxx/create npm init @xxx/foo -&gt; npx @xxx/create-foo</p><p>⬆️ @xx为命名空间，相当于一个依赖库的集合名称，而这些参数都会按照一定规则补充<code>create</code>名称</p><p>再来看这行指令<code>npm init vue@next</code>，需要注意到是依赖名后加<code>@xx</code>不是命名空间，而是指定版本 所以忽视安装依赖的版本则简化为 <code>npm init vue</code> 转化为<code>npx create-vue</code></p><p>而<a href="http://nodejs.cn/learn/the-npx-nodejs-package-runner" target="_blank" rel="noopener noreferrer">npx指令</a>，不仅能直接运行<code>node_modules</code>中的库，还能不把依赖安装到本地来运行指令(估计是安装到了本地缓存，运行完自动清除那种) 如下官方示例</p><div class="language-bash"><pre><code>npx cowsay <span class="token string">&quot;你好&quot;</span>
</code></pre></div><p>运行结果为</p><div class="language-console"><pre><code> _______
&lt; 你好 &gt;
 -------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
</code></pre></div><p>这是<code>npx</code>安装<code>cowsay</code>的库并运行后的结果</p><p>到这里我们知道了<code>npm init vue@next</code> 就是本地执行<code>npx create-vue</code> 本地安装<code>create-vue</code>的脚手架库(不安装到本地而是安装到缓存并运行完清除),并运行的运行搭建指令</p><blockquote><p>另外，npx的这个不安装到本地的特性其实也可以用到vue-cli的脚手架框架 即 <code>npx @vue/cli create demoName</code> 所以到这里并不能体现新的脚手架有多值得替换<code>npx create-vue</code></p></blockquote><h2 id="create-vue真正强大的地方在于他创建项目的速度" tabindex="-1">create-vue真正强大的地方在于他创建项目的速度 <a class="header-anchor" href="#create-vue真正强大的地方在于他创建项目的速度" aria-hidden="true">#</a></h2><blockquote><p>快的原因，主要在于依赖少（能不依赖包就不依赖），源码行数少，目前index.js只有300余行。</p></blockquote><blockquote><p>帮助创建项目的工具，都是下载项目模版和安装项目所需的依赖而已，这能怎么提升速度呢？</p></blockquote><h2 id="实现步骤分析" tabindex="-1">实现步骤分析 <a class="header-anchor" href="#实现步骤分析" aria-hidden="true">#</a></h2><p>以上只是简化了安装脚手架依赖的初始化步骤 开始询问式配置并创建项目文件夹和文件才是重点</p><ol><li>问答式输入配置</li><li>解析配置成数据结构</li><li>根据配置进行相应内置的插件初始化文件</li></ol><p>以上是主流程，同时提供</p><ol><li>解析指令式配置，跳过问答</li><li>检测同名项目文件夹，提示覆盖</li><li>ts需要修改所有js文件的后缀成ts</li><li>代码生成readme文件内容</li></ol><h2 id="一、初始化项目" tabindex="-1">一、初始化项目 <a class="header-anchor" href="#一、初始化项目" aria-hidden="true">#</a></h2><p>新建文件夹，运行指令</p><div class="language-bash"><pre><code><span class="token function">npm</span> init -y
</code></pre></div><p>在<code>package.json</code>中添加配置</p><div class="language-json"><pre><code><span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>👆从nodejs13开始,配置后(默认type为<code>commonjs</code>)内置ES Module模块化规范(以前只支持Commonjs)</p><blockquote><p>ES Module和Commonjs的区别，请看这里</p></blockquote><p><code>package.json</code>配置运行脚本</p><div class="language-json"><pre><code><span class="token punctuation">{</span>
  <span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node index.js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="二、实现问答式配置" tabindex="-1">二、实现问答式配置 <a class="header-anchor" href="#二、实现问答式配置" aria-hidden="true">#</a></h2><p>问答配置主要依赖于<a href="https://github.com/terkelg/prompts#readme" target="_blank" rel="noopener noreferrer">prompts库</a></p><div class="language-js"><pre><code><span class="token keyword">const</span> qaList <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;projectName&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 生成数据的keyName</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;text&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;Project name:&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 问答的问题</span>
    <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&#39;defualtVal&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 初始值</span>
    <span class="token function-variable function">onState</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>targetDir <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">prompts</span><span class="token punctuation">(</span>qaList<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">// { projectName: &#39;输入的值&#39; }</span>
<span class="token punctuation">}</span>
<span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="三、兼容指令配置-跳过问答" tabindex="-1">三、兼容指令配置,跳过问答 <a class="header-anchor" href="#三、兼容指令配置-跳过问答" aria-hidden="true">#</a></h2><h2 id="项目名重复-询问覆盖" tabindex="-1">项目名重复,询问覆盖 <a class="header-anchor" href="#项目名重复-询问覆盖" aria-hidden="true">#</a></h2><h2 id="根据问答数据生成模版文件" tabindex="-1">根据问答数据生成模版文件 <a class="header-anchor" href="#根据问答数据生成模版文件" aria-hidden="true">#</a></h2><h2 id="替换js模版成ts" tabindex="-1">替换js模版成ts <a class="header-anchor" href="#替换js模版成ts" aria-hidden="true">#</a></h2><blockquote><p>只用换文件后缀就可以了吗</p></blockquote><h2 id="从0编写生成readme文件" tabindex="-1">从0编写生成readme文件 <a class="header-anchor" href="#从0编写生成readme文件" aria-hidden="true">#</a></h2><hr><h2 id="git-clone项目把提交记录也保留下来" tabindex="-1">git clone项目把提交记录也保留下来 <a class="header-anchor" href="#git-clone项目把提交记录也保留下来" aria-hidden="true">#</a></h2><p>在 github 上新建一个仓库 <code>create-vue-analysis</code> 克隆下来</p><div class="language-bash"><pre><code><span class="token function">git</span> clone https://github.com/lxchuan12/create-vue-analysis.git
<span class="token builtin class-name">cd</span> create-vue-analysis
<span class="token function">git</span> subtree <span class="token function">add</span> --prefix<span class="token operator">=</span>create-vue https://github.com/vuejs/create-vue.git main
</code></pre></div><p>这样就把 create-vue 文件夹克隆到自己的 git 仓库了。且保留的 git 记录 复制代码 关于更多 git subtree，可以看<a href="https://segmentfault.com/a/1190000003969060" target="_blank" rel="noopener noreferrer">Git Subtree</a> 简明使用手册</p><h2 id="减少了删除文件夹依赖rimraf" tabindex="-1">减少了删除文件夹依赖<code>rimraf</code> <a class="header-anchor" href="#减少了删除文件夹依赖rimraf" aria-hidden="true">#</a></h2><p>自己实现一个利用多叉树深搜中的后序遍历，先删除子文件和子文件夹，才能保证当前文件夹为空，才能直接用<code>fs.rmdirSync</code>来删除文件夹 <code>多叉树深搜中的后序遍历</code>，看下面的代码也就普通的递归而已...这么高级的算法名字</p><div class="language-js"><pre><code><span class="token keyword">function</span> <span class="token function">postOrderDirectoryTraverse</span><span class="token punctuation">(</span><span class="token parameter">dir<span class="token punctuation">,</span> dirCallback<span class="token punctuation">,</span> fileCallback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> filename <span class="token keyword">of</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fullpath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
    <span class="token comment">// 如果是文件夹，递归</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">lstatSync</span><span class="token punctuation">(</span>fullpath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">postOrderDirectoryTraverse</span><span class="token punctuation">(</span>fullpath<span class="token punctuation">,</span> dirCallback<span class="token punctuation">,</span> fileCallback<span class="token punctuation">)</span>
      <span class="token comment">// 子文件和子文件夹都处理好了再来用 dirCallback 处理这个文件夹</span>
      <span class="token function">dirCallback</span><span class="token punctuation">(</span>fullpath<span class="token punctuation">)</span>
      <span class="token keyword">continue</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 如果是文件，直接用 fileCallback 处理</span>
    <span class="token function">fileCallback</span><span class="token punctuation">(</span>fullpath<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">emptyDir</span><span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 传入文件夹回调和文件回调</span>
  <span class="token function">postOrderDirectoryTraverse</span><span class="token punctuation">(</span>
    dir<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> fs<span class="token punctuation">.</span><span class="token function">rmdirSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> fs<span class="token punctuation">.</span><span class="token function">unlinkSync</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这个提升的速度不大吧...除此之外好像没有别的提升速度的地方了吧</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/typescript/vue2加ts" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>vue2加ts</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/vue/esbuild使用" data-v-38ede35f><span class="text" data-v-38ede35f>esbuild使用</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"http_http2.md\":\"f913a313\",\"http_http3.md\":\"060f1a93\",\"http_http缓存.md\":\"31fc5d76\",\"index.md\":\"e233a088\",\"innermanage_内管前端工程.md\":\"e613f30e\",\"interview_js基础.md\":\"f3bc5865\",\"interview_todo.md\":\"199537bf\",\"interview__过.md\":\"865ff21e\",\"interview_前端面试之道.md\":\"ec1a40c2\",\"interview_各种题目01.md\":\"079c680b\",\"interview_手写系列-callbind.md\":\"12930746\",\"interview_手写系列-instanceof.md\":\"5ef6c309\",\"interview_手写系列-map和filter和reduce.md\":\"7d9d2352\",\"interview_手写系列-new原理.md\":\"a96cf990\",\"interview_手写系列-settime模拟setinterval.md\":\"e387ac1a\",\"interview_手写系列-发布订阅和观察者.md\":\"a516d630\",\"interview_手写系列-复杂axios.md\":\"ed7137b3\",\"interview_手写系列-复杂promise.md\":\"4e5735bb\",\"interview_手写系列-数组转树.md\":\"c01229aa\",\"interview_手写系列-深拷贝.md\":\"79f771f4\",\"interview_手写系列-防抖节流.md\":\"060f760c\",\"interview_算法01.md\":\"182a4137\",\"jiagou_monorepo.md\":\"51eb3439\",\"jiagou_从0到1构建符合标准的公共库.md\":\"99849ee2\",\"jiagou_切换主题方案.md\":\"501a1a5e\",\"jiagou_前端基础建设与架构30讲.md\":\"f7baf6ec\",\"jiagou_搭建组件库.md\":\"d9bc651d\",\"jiagou_深入babel.md\":\"9abe1423\",\"jiagou_自动生成按需导出目录.md\":\"5f601077\",\"jiagou_表单组件带校验功能.md\":\"d794d549\",\"js_object.entries.md\":\"3ba00128\",\"js_class和构造函数.md\":\"d5c78ad6\",\"js_dayformat正则的使用.md\":\"8abaaa7f\",\"js_luhn算法.md\":\"ffeffec6\",\"js_proxy.md\":\"a7b2ad3a\",\"js_优雅的class.md\":\"497ed7e9\",\"js_前端模块化.md\":\"ed11c518\",\"js_浏览器垃圾回收.md\":\"b6fa7d93\",\"js_深入babel.md\":\"92842df6\",\"js_闭包与垃圾回收.md\":\"bd9a10f4\",\"microfrontend_介绍.md\":\"9ff9f87d\",\"microfrontend_拟定微前端架构设计.md\":\"fccf143e\",\"microfrontend_架构思想.md\":\"748e5304\",\"node_cheetah-learn.md\":\"95e6fcd1\",\"node_cli相关学习.md\":\"c29bfdd7\",\"performance_serviceworker.md\":\"6f67fcf2\",\"performance_ssr.md\":\"0f412a14\",\"performance_慕课网web性能优化.md\":\"f53c24bc\",\"typescript_vue2加ts.md\":\"9d17aaa6\",\"vue_create-vue脚手架.md\":\"89f2fa24\",\"vue_esbuild使用.md\":\"7977b135\",\"vue_keep-alive原理.md\":\"ef31ebc9\",\"vue_vue-router实现原理.md\":\"6106cd66\",\"vue_模板编译.md\":\"50b03259\",\"vue_路由页面历史栈的处理.md\":\"8b4132c2\",\"vue_重学vue-01模板语法.md\":\"436fc3ef\",\"vue_重学vue-02数据驱动视图.md\":\"d89737de\",\"vue_重学vue-03render函数.md\":\"1cc2f4a1\",\"vue_重学vue-04内置指令.md\":\"59840a53\",\"vue_重学vue-05filter多余吗.md\":\"02057bf4\",\"vue_重学vue-06computer.md\":\"10c8a4d4\",\"vue_重学vue-07watch.md\":\"25d56e53\",\"vue_重学vue-08组件.md\":\"3d21f25c\",\"vue_重学vue-09生命周期.md\":\"786dacfb\",\"vue_重学vue-10ref是什么.md\":\"a29dd7e6\",\"vue_重学vue-11nexttick.md\":\"35043fa8\",\"vue_重学vue-8组件通信.md\":\"4845edc5\",\"vue_重学vue-vue.use.md\":\"cc4266d2\",\"vue_重学vue-动画内置组件.md\":\"04d4553c\",\"vue3_elementplus.md\":\"2f3aeef9\",\"vue3_入门.md\":\"33504c8d\",\"webcomponents_1. webcomponent介绍.md\":\"29a6407a\",\"webcomponents_2. customelements.md\":\"9e1088a3\",\"webpack_1.md\":\"7279a63f\",\"webpack__草稿.md\":\"39f16499\",\"webpack_实现一个自己的脚手架.md\":\"b4d5365f\",\"webpack_重学webpack-01打包工具的思考.md\":\"083571d8\",\"webpack_重学webpack-02模块化原理.md\":\"0650e76f\",\"webpack_重学webpack-03loader.md\":\"43789662\",\"webpack_重学webpack-04plugin.md\":\"73454000\",\"webpack_重学webpack-05hmr热更新.md\":\"007085b5\",\"week_202110-1.md\":\"ecb6af64\",\"week_202110-2.md\":\"59fce584\",\"week_202111-1.md\":\"7d3ac50a\",\"week__0todo.md\":\"d60b5fc0\",\"week_缓存工具方法思路.md\":\"13a83606\",\"work_ios小白条问题.md\":\"cf9e950f\"}")</script>
    <script type="module" async src="/assets/app.d95e124d.js"></script>
    
  </body>
</html>